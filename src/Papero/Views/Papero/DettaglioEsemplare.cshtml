@*
    DettaglioEsemplare
    Vista che mostra la scheda di dettaglio del singolo esemplare
*@


@model Papero.ViewModels.DettaglioEsemplareViewModel


@using Papero.Models;
@using Microsoft.Extensions.Options;
@inject IOptions<OpzioniQRCode> opzioni
@inject IOptions<OpzioniImmagini> opzioni_immagini

@{
    ViewBag.Title = localizzatore["Dettaglio Esemplare"];
    var _opzioni = opzioni.Value;
    var _opzioni_immagini = opzioni_immagini.Value;
}

@section css {



    <style type="text/css">
        @* Questi tre stili servono per invertire il modo in cui dt e dd mostrano il loro contenuto. I dt diventano testo normale mentre i dd diventano testo in grassetto. *@ dt {
            font-weight: normal;
        }

        dd {
            font-weight: bold;
        }

        .dl-horizontal dt {
            white-space: normal;
        }

        @* Questi due stili servono per trasformare "ng-show" da "display:none" a "visibility:hidden" e quindi incolonnare giuste le frecce per muovere su e giù le righe nelle tabelle *@ .fa.fa-arrow-up.ng-hide {
            display: inline-block !important;
            visibility: hidden;
        }

        .fa.fa-arrow-down.ng-hide {
            display: inline-block !important;
            visibility: hidden;
        }
    </style>
}

@section scripts {

    <script src="~/js/modali/modaleNomiController.js"></script>
    <script src="~/js/modali/modaleElencoAutoriController.js"></script>
    <script src="~/js/modali/modaleModiPreparazioneController.js"></script>
    <script src="~/js/pulsanteMSNGController.js"></script>
    <script src="~/js/modali/modaleVecchieDeterminazioniController.js"></script>
    <script src="~/js/modali/modaleGeografiaController.js"></script>
    <script src="~/js/modali/modaleDatiGeneraliController.js"></script>
    <script src="~/js/modali/modaleDeterminazioniController.js"></script>
    <script src="~/js/modali/modalePreparazioneController.js"></script>
    <script src="~/js/modali/modaleImmaginiController.js"></script>

    <script src="~/lib/jquery-validation/dist/jquery.validate.min.js"></script>
    <script src="~/lib/jquery-validation-unobtrusive/jquery.validate.unobtrusive.min.js"></script>

    <script>
        $('#modaleElencoAutori').on('hidden.bs.modal', function () {       //  Questi eventi sono le chiusure (non submit) di alcune modali (non tutte). Queste modali richiedono che la
            location.reload(true);                                         //  pagina venga ricaricata per resettare correttamente le tabelle (altrimenti rimarrebbero i valori modificati)
        });
        $('#modaleModiPreparazione').on('hidden.bs.modal', function () {
            location.reload(true);
        });
        $('#modaleMorfologia').on('hidden.bs.modal', function () {
            location.reload(true);
        });
        $('#modaleVecchieDeterminazioni').on('hidden.bs.modal', function () {
            location.reload(true);
        });

        $('#formMorfologia').validate({ errorPlacement: function (error, element) { return true; } });  // Questo comando abilita la validazione ma disattiva i messaggi di default

        $('#formPreparazione').validate({ errorPlacement: function (error, element) { return true; } });  // Questo comando abilita la validazione ma disattiva i messaggi di default

        function validaFormMorfologia() {                                                    // Questa funzione controlla tutti i campi numerici della modale di Morfologia e abilita/disabilita
            $('#bottoneSubmitMorfologia').prop('disabled', !$('#formMorfologia').valid());   // il pulsante di submit in base alla loro validità
        }

        function validaFormPreparazione() {                                                    // Questa funzione controlla tutti i campi numerici della modale di Preparazione e abilita/disabilita
            $('#bottoneSubmitPreparazione').prop('disabled', !$('#formPreparazione').valid());   // il pulsante di submit in base alla loro validità
        }
    </script>
}
<div class="row" ng-app="papero-app">
    <div class="col-lg-12">

        <div class="panel panel-primary">
            <div class="panel-heading">
                <div class="row">
                    <div class="col-lg-2" ng-controller="pulsanteMSNGController as vm">

                        @if (ViewBag.trovato)
                        {
<!--#region modaleConfermaCancellazione -->
                            <div class="modal fade" id="modaleConfermaCancellazione" role="dialog">
                                <div class="modal-dialog modal-lg">
                                    <div class="modal-content">
                                        <div class="modal-body">

                                            <div class="panel panel-danger">
                                                <div class="panel-heading">
                                                    <h3 class="panel-title">@localizzatore["Confermare la cancellazione: l'operazione non può essere annullata"]<i role="button" class="fa fa-close fa-pull-right text-white" data-dismiss="modal"></i></h3>
                                                </div>
                                                <div class="panel-body text-primary">

                                                    <form class="form-horizontal"
                                                          id="formCancellaEsemplare"
                                                          name="formCancellaEsemplare"
                                                          asp-controller="UpdateDettaglioEsemplare"
                                                          asp-action="CancellaEsemplare">
                                                        <fieldset>

                                                            <input type="hidden" id="esemplarehiddenCancellaEsemplare" asp-for="Id" value="@Model.Id" />

                                                            <div class="form-group text-center">
                                                                <h3>
                                                                    @funzioni.FormattaNomeScientifico(Model.Sottospecie.Specie.Genere.Nome,
                                                                                                      Model.Sottospecie.Specie.Nome,
                                                                                                      Model.Sottospecie.Nome,
                                                                                                      Model.Sottospecie.ElencoAutori)
                                                                </h3>


                                                                <h3>
                                                                    @localizzatore["MSNG"]: <strong>@Model.Msng</strong>
                                                                </h3>
                                                            </div>

                                                            <div class="form-group text-center">
                                                                <div class="col-lg-12">
                                                                    <button type="reset" class="btn btn-outline-primary" data-dismiss="modal">@localizzatore["Annulla"]</button>
                                                                    <button type="submit" class="btn btn-danger">@localizzatore["Cancella Esemplare"]</button>
                                                                </div>
                                                            </div>
                                                        </fieldset>
                                                    </form>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <!-- #endregion -->

<!--#region modaleCambioMSNG -->
                            <div class="modal fade" id="modaleCambioMSNG" role="dialog">
                                <div class="modal-dialog modal-lg">
                                    <div class="modal-content">
                                        <div class="modal-body">

                                            <div class="panel panel-primary">
                                                <div class="panel-heading">
                                                    <h3 class="panel-title">@localizzatore["Inserire nuovo MSNG"]:<i role="button" class="fa fa-close fa-pull-right text-white" data-dismiss="modal"></i></h3>
                                                </div>
                                                <div class="panel-body text-primary">

                                                    <form class="form-horizontal"
                                                          id="formCambioMSNG"
                                                          name="formCambioMSNG"
                                                          asp-controller="UpdateDettaglioEsemplare"
                                                          asp-action="CambioMSNGEsemplare">
                                                        <fieldset>
                                                            <input type="hidden" id="MSNGhiddenCambioMSNG" name="MSNGhiddenCambioMSNG" value="@Model.Msng" />
                                                            <input type="hidden" id="esemplarehiddenCambioMSNG" asp-for="Id" value="@Model.Id" />

                                                            <div class="form-group">
                                                                <label for="inputCambioMSNG" class="col-lg-1 col-lg-offset-4 control-label text-primary">@localizzatore["MSNG"]:</label>
                                                                <div class="col-lg-3">
                                                                    @*<input class="form-control" type="number" id="inputCambioMSNG" name="inputCambioMSNG" value="@Model.Msng" />*@

                                                                    <input type="text" pattern="([1-9][0-9]*)" id="inputCambioMSNG" name="inputCambioMSNG" ng-model="vm.cambioMSNG" ng-change="vm.controllaCambioMSNG()" class="form-control" required>

                                                                </div>
                                                            </div>

                                                            <div class="alert alert-danger col-lg-4 col-lg-offset-4" ng-show="vm.MSNGdoppio">
                                                                <strong>@localizzatore["MSNG già esistente!"]</strong>
                                                            </div>

                                                            <div class="form-group">
                                                                <div class="col-lg-12">
                                                                    <div class="pull-right">
                                                                        <button type="reset" class="btn btn-outline-primary" data-dismiss="modal">@localizzatore["Annulla"]</button>
                                                                        <button type="button" id="submitCambioMSNG" ng-disabled="vm.submitCambioMSNGdisabilitato" ng-click="vm.verificaPresenzaMSNG()" class="btn btn-success">@localizzatore["Aggiorna"]</button>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </fieldset>
                                                    </form>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <!-- #endregion -->
                        }
                        <form asp-controller="Papero"
                              asp-action="DettaglioEsemplareByMSNG"
                              id="formMSNG"
                              name="formMSNG">
                            @if ((await autorizzatore.AuthorizeAsync(User, "CambioMSNGEsemplare")) && (ViewBag.trovato))
                            {
                                <i role="button"
                                   class="fa fa-pencil text-muted"
                                   data-toggle="modal"
                                   data-target="#modaleCambioMSNG"
                                   ng-click="vm.apriModaleCambioMSNG(@Model.Id, @Model.Msng)">
                                </i>
                            }
                            <div class="form-group">
                                <div class="input-group input-group-lg">
                                    <input type="text" pattern="([1-9][0-9]*)" id="inputMSNG" ng-model="vm.MSNG" ng-change="vm.controllaMSNG()" class="form-control form-control-lg" asp-for="Msng" required>
                                    <span class="input-group-btn">
                                        <button class="btn btn-success btn-lg" type="submit" ng-disabled="vm.controllaMSNG()">@localizzatore["MSNG"]</button>
                                    </span>
                                </div>
                            </div>

                        </form>
                    </div>


                    @*
                        Il render della pagina viene effettuato solo se l'ID passato è valido. In caso contrario viene visualizzato un messaggio di errore.
                    *@
                    @if (ViewBag.trovato)
                    {
                        <div class="col-lg-4" ng-controller="modaleElencoAutoriController as vm">

                            <input type="hidden" id="inputIdSottospecie" value="@Model.Sottospecie.Id" />
                            <input type="hidden" id="inputIdEsemplare" value="@Model.Id" />
                            <!--#region modaleElencoAutori -->
                            <div class="modal fade" id="modaleElencoAutori" role="dialog">
                                <div class="modal-dialog modal-lg">
                                    <div class="modal-content">
                                        <div class="modal-body">

                                            <div class="panel panel-primary">
                                                <div class="panel-heading">
                                                    <h3 class="panel-title">@localizzatore["Inserire i nuovi valori"]:<i role="button" class="fa fa-close fa-pull-right text-white" data-dismiss="modal"></i></h3>
                                                </div>
                                                <div class="panel-body text-primary">

                                                    <form class="form-horizontal"
                                                          id="formElencoAutori"
                                                          name="formElencoAutori"
                                                          asp-controller="UpdateDettaglioEsemplare"
                                                          asp-action="AggiornaAutori">
                                                        <fieldset>
                                                            <input type="hidden" id="sottospeciehiddenElencoAutori" asp-for="SottospecieId" value="@Model.Sottospecie.Id" />
                                                            <input type="hidden" id="esemplarehiddenElencoAutori" asp-for="Id" value="@Model.Id" />
                                                            <input type="hidden" id="parametroElencoAutori" name="parametroElencoAutori" />
                                                            <div class="form-group text-center">
                                                                <h3>
                                                                    <span class="text-muted">
                                                                        @funzioni.FormattaNomeScientifico(Model.Sottospecie.Specie.Genere.Nome,
                                                                                                          Model.Sottospecie.Specie.Nome,
                                                                                                          Model.Sottospecie.Nome)
                                                                    </span>
                                                                    <br />
                                                                    <span class="text-primary">{{vm.stringaElencoAutori}}</span>
                                                                </h3>


                                                            </div>
                                                            <div class="form-group">
                                                                <label for="inputAnnoClassificazione" class="col-lg-3 col-lg-offset-2 control-label text-primary">@localizzatore["Anno Classificazione"]:</label>
                                                                <div class="col-lg-2">
                                                                    <input type="hidden" id="annoClassificazioneDB" name="annoClassificazioneDB" value="@Model.Sottospecie.AnnoClassificazione" />
                                                                    <input type="number"
                                                                           min="1700" max="2100"
                                                                           class="form-control"
                                                                           id="inputAnnoClassificazione"
                                                                           name="inputAnnoClassificazione"
                                                                           ng-model="vm.annoClassificazione"
                                                                           value="@Model.Sottospecie.AnnoClassificazione"
                                                                           ng-change="vm.aggiornaElencoAutori()" required>
                                                                </div>
                                                            </div>
                                                            <div class="form-group">
                                                                <label for="inputClassificazioneOriginale" class="col-lg-3 col-lg-offset-2 control-label text-primary">@localizzatore["Classificazione Originale"]:</label>
                                                                <div class="col-lg-1">
                                                                    <input type="hidden"
                                                                           id="classificazioneOriginaleDB"
                                                                           name="classificazioneOriginaleDB"
                                                                           value="@((bool)Model.Sottospecie.ClassificazioneOriginale ? "true" : "false")" />
                                                                    <input type="checkbox"
                                                                           class="form-control"
                                                                           id="inputClassificazioneOriginale"
                                                                           name="inputClassificazioneOriginale"
                                                                           ng-change="vm.aggiornaElencoAutori()"
                                                                           ng-model="vm.classificazioneOriginale"
                                                                           checked="@Model.Sottospecie.ClassificazioneOriginale" />
                                                                </div>
                                                            </div>
                                                            <div class="form-group">
                                                                <label for="dropdownAutori" class="col-lg-3 col-lg-offset-2 control-label text-primary">@localizzatore["Classificatore"]:</label>
                                                                <div class="col-lg-4">
                                                                    <select id="dropdownAutori"
                                                                            class="form-control"
                                                                            ng-model="vm.autoreSelezionato"
                                                                            ng-options="autore.classificatore for autore in vm.datiDropdownAutori track by autore.id"></select>
                                                                </div>
                                                                <div class="col-lg-1">
                                                                    <i role="button" ng-click="vm.aggiungiAutore()" class="fa fa-plus-square fa-2x text-success"></i>
                                                                </div>
                                                            </div>

                                                            <div class="form-group">
                                                                <div class="col-lg-offset-2 col-lg-8">
                                                                    <div style="overflow-y:auto; overflow-x:hidden; max-height:300px;">
                                                                        <input type="hidden" id="tabellaElencoAutoriSerializzata" name="tabellaElencoAutoriSerializzata" />
                                                                        <table datatable="ng" class="table table-striped table-bordered table-hover text-primary" id="tabellaElencoAutori" dt-options="vm.opzioniTabellaElencoAutori">
                                                                            <thead>
                                                                                <tr>
                                                                                    <th>@localizzatore["Ordinamento"]</th>
                                                                                    <th>@localizzatore["Classificatore"]</th>
                                                                                    <th></th>
                                                                                </tr>
                                                                            </thead>
                                                                            <tbody>
                                                                                <tr ng-repeat="autore in vm.datiTabellaAutori">
                                                                                    <td>{{$index+1}}</td>
                                                                                    <td>{{autore.classificatore}}</td>
                                                                                    <td>
                                                                                        <div class="btn-group fa-pull-right">
                                                                                            <i role="button" ng-show="!$first" ng-click="vm.spostaSu($index)" class="fa fa-arrow-up fa-2x text-success"></i>
                                                                                            <i role="button" ng-show="!$last" ng-click="vm.spostaGiu($index)" class="fa fa-arrow-down fa-2x text-success"></i>
                                                                                            <i role="button" ng-click="vm.rimuoviAutore(autore)" class="fa fa-minus-square fa-2x text-danger"></i>
                                                                                        </div>
                                                                                    </td>
                                                                                </tr>
                                                                            </tbody>
                                                                        </table>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <div class="form-group">
                                                                <div class="col-lg-12">
                                                                    <div class="pull-right">
                                                                        <button type="reset" class="btn btn-outline-primary" data-dismiss="modal">@localizzatore["Annulla"]</button>
                                                                        <button type="submit" id="submitElencoAutori" class="btn btn-success" ng-disabled="formElencoAutori.$invalid || vm.invalido">@localizzatore["Inserisci"]</button>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </fieldset>
                                                    </form>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>

<!--#region modaleCambioTaxa -->
                            <div class="modal fade" id="modaleCambioTaxa" role="dialog">
                                <div class="modal-dialog modal-lg">
                                    <div class="modal-content">
                                        <div class="modal-body">

                                            <div class="panel panel-primary">
                                                <div class="panel-heading">
                                                    <h3 class="panel-title">@localizzatore["Inserire nuovo Taxa"]:<i role="button" class="fa fa-close fa-pull-right text-white" data-dismiss="modal"></i></h3>
                                                </div>
                                                <div class="panel-body text-primary">

                                                    <form class="form-horizontal"
                                                          id="formCambioTaxa"
                                                          name="formCambioTaxa"
                                                          asp-controller="UpdateDettaglioEsemplare"
                                                          asp-action="CambioTaxaEsemplare">
                                                        <fieldset>
                                                            <input type="hidden" id="sottospeciehiddenCambioTaxa" name="sottospeciehiddenCambioTaxa" />
                                                            <input type="hidden" id="esemplarehiddenCambioTaxa" asp-for="Id" value="@Model.Id" />

                                                            <div class="form-group">
                                                                <label for="uiselectSingolaSpecie" class="col-lg-1 col-lg-offset-2 control-label text-primary">@localizzatore["Taxa"]:</label>
                                                                <div class="col-lg-7">

                                                                    <div>
                                                                        <ui-select id="uiselectSingolaSpecie" ng-model="vm.SpecieSelezionataCambioTaxa" ng-change="vm.selezionaSpecieCambioTaxa()">
                                                                            <ui-select-match>
                                                                                <span ng-bind="$select.selected.nome"></span>
                                                                            </ui-select-match>
                                                                            <ui-select-choices repeat="specie in (vm.ElencoSpecieCambioTaxa | filter: $select.search) track by specie.id">
                                                                                <span ng-bind="specie.nome"></span>
                                                                            </ui-select-choices>
                                                                        </ui-select>
                                                                    </div>

                                                                </div>
                                                            </div>




                                                            <div class="form-group">
                                                                <div class="col-lg-12">
                                                                    <div class="pull-right">
                                                                        <button type="reset" class="btn btn-outline-primary" data-dismiss="modal">@localizzatore["Annulla"]</button>
                                                                        <button type="submit" id="submitCambioTaxa" class="btn btn-success">@localizzatore["Aggiorna"]</button>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </fieldset>
                                                    </form>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <!-- #endregion -->

                            <h4>
                                @funzioni.FormattaNomeScientifico(Model.Sottospecie.Specie.Genere.Nome,
                                                                  Model.Sottospecie.Specie.Nome,
                                                                  Model.Sottospecie.Nome)
                                @switch (Model.Sesso.Sesso)
                                {
                                    case "Maschio": <text>&nbsp;</text><i class="fa fa-mars"></i>
                                        break;
                                    case "Femmina": <text>&nbsp;</text><i class="fa fa-venus"></i>
                                        break;
                                    case "Prob. Maschio":<text>&nbsp;?&nbsp;</text><i class="fa fa-mars"></i>
                                        break;
                                    case "Prob. Femmina":<text>&nbsp;?&nbsp;</text><i class="fa fa-venus"></i>
                                        break;
                                }

                                @if (await autorizzatore.AuthorizeAsync(User, "CambioTaxaEsemplare"))
                                {
                                    <i role="button" class="fa fa-pencil text-muted" data-toggle="modal" data-target="#modaleCambioTaxa" ng-click="vm.apriModaleCambioTaxa(@Model.Id, @Model.SottospecieId)"></i>
                                }

                                <br />
                                @Model.Sottospecie.ElencoAutori

                                @if (await autorizzatore.AuthorizeAsync(User, "ModificaElencoAutori"))
                                {
                                    <text>&nbsp;</text><i role="button" class="fa fa-pencil text-muted" data-toggle="modal" data-target="#modaleElencoAutori" ng-click="vm.apriModaleElencoAutori(@Model.Sottospecie.Id)"></i>
                                }
                            </h4>

                        </div>

                        <div class="col-lg-2">
                            <dl class="dl-horizontal text-white">
                                <dt>@localizzatore["Famiglia"]:</dt>
                                <dd>@Model.Sottospecie.Specie.Genere.Tribu.Sottofamiglia.Famiglia.Nome</dd>
                                <dt>@localizzatore["Sottofamiglia"]:</dt>
                                <dd>@Model.Sottospecie.Specie.Genere.Tribu.Sottofamiglia.Nome</dd>
                                <dt>@localizzatore["Tribu"]:</dt>
                                <dd>@Model.Sottospecie.Specie.Genere.Tribu.Nome</dd>
                            </dl>
                        </div>

                        <div class="col-lg-4" ng-controller="modaleNomiController as vm">
<!-- #region modaleNomi -->
                            <div class="modal fade" id="modaleNomi" role="dialog">
                                <div class="modal-dialog modal-lg">
                                    <div class="modal-content">
                                        <div class="modal-body">

                                            <div class="panel panel-primary">
                                                <div class="panel-heading">
                                                    <h3 class="panel-title">@localizzatore["Inserire i nuovi valori"]:<i role="button" class="fa fa-close fa-pull-right text-white" data-dismiss="modal"></i></h3>
                                                </div>
                                                <div class="panel-body">

                                                    <form class="form-horizontal"
                                                          asp-controller="UpdateDettaglioEsemplare"
                                                          asp-action="AggiornaNomi">
                                                        <fieldset>
                                                            <input type="hidden" id="sottospeciehidden" asp-for="SottospecieId" value="@Model.Sottospecie.Id" />
                                                            <input type="hidden" id="esemplarehidden" asp-for="Id" value="@Model.Id" />
                                                            <div class="form-group">
                                                                <label for="nomeItaliano" class="col-lg-2 control-label text-primary">@localizzatore["Nome Italiano"]:</label>
                                                                <div class="col-lg-10">
                                                                    <input type="text" class="form-control" asp-for="Sottospecie.NomeItaliano" id="nomeItaliano" name="nomeItaliano" value="@Model.Sottospecie.NomeItaliano" ng-model="vm.nomeItaliano">
                                                                </div>
                                                            </div>
                                                            <div class="form-group">
                                                                <label for="nomeInglese" class="col-lg-2 control-label text-primary">@localizzatore["Nome Inglese"]:</label>
                                                                <div class="col-lg-10">
                                                                    <input type="text" class="form-control" asp-for="Sottospecie.NomeInglese" id="nomeInglese" name="nomeInglese" value="@Model.Sottospecie.NomeInglese" ng-model="vm.nomeInglese">
                                                                </div>
                                                            </div>
                                                            <div class="form-group">
                                                                <label for="statiConservazione" class="col-lg-2 control-label text-primary">@localizzatore["Stato di Conservazione"]:</label>
                                                                <div class="col-lg-10">
                                                                    @*
                                                                        Questo input nascosto serve per memorizzare il valore dello stato di conservazione così come arriva dal modello.
                                                                        In seguito, se viene aperta #modaleNomi, viene utilizzato per impostare il valore della select.
                                                                    *@
                                                                    <input type="hidden" id="statoConservazioneDB" value="@Model.Sottospecie.StatoConservazioneId" />

                                                                    <select id="statiConservazione"
                                                                            name="statoConservazione"
                                                                            class="form-control"
                                                                            ng-model="vm.statoConservazioneSelezionato">
                                                                        <option ng-repeat="statoConservazione in vm.elencoStatiConservazione" ng-selected="statoConservazione.id == statoConservazioneDB.value" value="{{statoConservazione.id}}">{{statoConservazione.statoConservazione}}</option>
                                                                    </select>
                                                                </div>
                                                            </div>
                                                            <div class="form-group">
                                                                <div class="col-lg-12">
                                                                    <div class="pull-right">
                                                                        <button type="reset" class="btn btn-outline-primary" data-dismiss="modal">@localizzatore["Annulla"]</button>
                                                                        <button type="submit" class="btn btn-success">@localizzatore["Inserisci"]</button>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </fieldset>
                                                    </form>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <!-- #endregion -->
                            <div class="card card-outline-primary">
                                <dl class="dl-horizontal text-white">
                                    <dt>
                                        @if (await autorizzatore.AuthorizeAsync(User, "ModificaNomiSottospecie"))
                                        {
                                            <i role="button" class="fa fa-pencil fa-pull-left fa-fw text-muted" data-toggle="modal" data-target="#modaleNomi" ng-click="vm.apriModaleNomi()"></i>
                                        }
                                        @localizzatore["Nome Italiano"]:
                                    </dt>
                                    <dd id="nomeItalianoDD">@Model.Sottospecie.NomeItaliano</dd>
                                    <dt>@localizzatore["Nome Inglese"]:</dt>
                                    <dd id="nomeIngleseDD">@Model.Sottospecie.NomeInglese</dd>
                                    <dt>@localizzatore["Stato di Conservazione"]:</dt>
                                    <dd>
                                        @(string.IsNullOrWhiteSpace(Model.Sottospecie.StatoConservazione.StatoConservazione) || Model.Sottospecie.StatoConservazione.StatoConservazione == "-"
                                    ? ""
                                    : Model.Sottospecie.StatoConservazione.StatoConservazione + " (" + Model.Sottospecie.StatoConservazione.Sigla + ")")
                                    </dd>
                                </dl>
                            </div>
                        </div>
                        <div class="row" ng-controller="modaleImmaginiController as vm">

<!--#region modaleUploadImmagini -->
                            <div class="modal fade" id="modaleUploadImmagini" role="dialog">
                                <div class="modal-dialog modal-lg">
                                    <div class="modal-content">
                                        <div class="modal-body">

                                            <div class="panel panel-primary">
                                                <div class="panel-heading">
                                                    <h3 class="panel-title">
                                                        <span class="fa-stack">
                                                            <i class="fa fa-square-o fa-stack-2x"></i>
                                                            <i class="fa fa-image fa-stack-1x"></i>
                                                        </span>
                                                        @localizzatore["Carica Immagini"]:<i role="button" class="fa fa-close fa-pull-right text-white" data-dismiss="modal"></i>
                                                    </h3>
                                                </div>
                                                <div class="panel-body text-primary">

                                                    <form id="fileupload" 
                                                          asp-controller="UploadImmagini" 
                                                          asp-action="Upload" 
                                                          method="POST" 
                                                          enctype="multipart/form-data" 
                                                          data-file-upload="options" 
                                                          data-ng-class="{'fileupload-processing': processing() || loadingFiles}">

                                                        @*<noscript><input type="hidden" name="redirect" value="https://blueimp.github.io/jQuery-File-Upload/"></noscript>*@

                                                        <input type="hidden" id="idEsemplare" name="idEsemplare" value="@Model.Id"/>

                                                        <div class="row fileupload-buttonbar">
                                                            <div class="col-lg-7">
                                                                <!-- The fileinput-button span is used to style the file input field as button -->
                                                                <span class="btn btn-primary fileinput-button" ng-class="{disabled: disabled}">
                                                                    <i class="fa fa-plus"></i>
                                                                    <span>@localizzatore["Aggiungi Immagini"]</span>
                                                                    <input type="file" name="files[]" multiple ng-disabled="disabled">
                                                                </span>
                                                                <!-- The global file processing state -->
                                                                <span class="fileupload-process"></span>
                                                            </div>

                                                            <div class="col-lg-5 fade" data-ng-class="{in: active()}">
                                                                <!-- The global progress bar -->
                                                                <div class="progress progress-striped active" data-file-upload-progress="progress()"><div class="progress-bar progress-bar-success" data-ng-style="{width: num + '%'}"></div></div>
                                                                <!-- The extended global progress state -->
                                                                <div class="progress-extended">&nbsp;</div>
                                                            </div>
                                                        </div>

                                                        <table class="table table-striped files ng-cloak">
                                                            <thead>
                                                                <tr>
                                                                    <th>@localizzatore["Immagine"]</th>
                                                                    <th>@localizzatore["Nome file"]</th>
                                                                    <th>@localizzatore["Didascalia"]</th>
                                                                    <th></th>
                                                                </tr>
                                                            </thead>
                                                            <tr data-ng-repeat="file in queue" data-ng-class="{'processing': file.$processing()}">
                                                                <td data-ng-switch data-on="!!file.thumbnailUrl">
                                                                    <div class="preview" data-ng-switch-when="true">
                                                                        <a data-ng-href="{{file.url}}" title="{{file.name}}" download="{{file.name}}" data-gallery><img data-ng-src="{{file.thumbnailUrl}}" alt=""></a>
                                                                    </div>
                                                                    <div class="preview" data-ng-switch-default data-file-upload-preview="file"></div>
                                                                </td>
                                                                <td>
                                                                    <p class="name" data-ng-switch data-on="!!file.url">
                                                                        <span data-ng-switch-when="true" data-ng-switch data-on="!!file.thumbnailUrl">
                                                                            <a data-ng-switch-when="true" data-ng-href="{{file.url}}" title="{{file.name}}" download="{{file.name}}" data-gallery>{{file.name}}</a>
                                                                            <a data-ng-switch-default data-ng-href="{{file.url}}" title="{{file.name}}" download="{{file.name}}">{{file.name}}</a>
                                                                        </span>
                                                                        <span data-ng-switch-default>{{file.name}}</span>
                                                                    </p>
                                                                    <strong data-ng-show="file.error" class="error text-danger">{{file.error}}</strong>
                                                                </td>
                                                                <td ng-hide="true">
                                                                    <p class="size">{{file.size | formatFileSize}}</p>
                                                                    <div class="progress progress-striped active fade" data-ng-class="{pending: 'in'}[file.$state()]" data-file-upload-progress="file.$progress()"><div class="progress-bar progress-bar-success" data-ng-style="{width: num + '%'}"></div></div>
                                                                </td>
                                                                <td>
                                                                    <textarea name="didascalia" ng-model="file.didascalia" class="form-control" style="width: 100%; height: 100%; border: thin; box-sizing:border-box"></textarea>
                                                                </td>

                                                                <td>
                                                                    @*<button type="button" class="btn btn-sm btn-primary start" data-ng-click="file.$submit()" data-ng-hide="!file.$submit || options.autoUpload" data-ng-disabled="file.$state() == 'pending' || file.$state() == 'rejected'">
                                                                        <i class="fa fa-upload"></i>
                                                                        <span>@localizzatore["Carica"]</span>
                                                                    </button>*@
                                                                    <button type="button" class="btn btn-sm btn-warning cancel" data-ng-click="file.$cancel()" data-ng-hide="!file.$cancel">
                                                                        <i class="fa fa-ban"></i>
                                                                        <span>@localizzatore["Rimuovi"]</span>
                                                                    </button>
                                                                    <button type="button" class="btn btn-sm btn-danger destroy" data-ng-click="file.$destroy()" data-ng-hide="!file.$destroy">
                                                                        <i class="fa fa-trash"></i>
                                                                        <span>@localizzatore["Cancella"]</span>
                                                                    </button>
                                                                </td>
                                                            </tr>
                                                        </table>

                                                        <div class="row fileupload-buttonbar">
                                                            <div class="col-lg-5 pull-right">
                                                                <button type="button" class="btn btn-outline-primary cancel" data-ng-click="cancel()" data-dismiss="modal">
                                                                    <span>@localizzatore["Annulla"]</span>
                                                                </button>
                                                                <button type="button" 
                                                                        class="btn btn-success start" 
                                                                        data-ng-click="submit()">
                                                                    <span>@localizzatore["Carica Immagini"]</span>
                                                                </button>
                                                            </div>
                                                        </div>
                                                    </form>

                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
<!--#endregion -->



<!--#region modaleVisualizzaImmagini -->
                            <div class="modal fade" id="modaleVisualizzaImmagini" role="dialog">
                                <div class="modal-dialog modal-lg">
                                    <div class="modal-content">
                                        <div class="modal-body">

                                            <div class="panel panel-primary">
                                                <div class="panel-heading">
                                                    <h3 class="panel-title">
                                                        <span class="fa-stack">
                                                            <i class="fa fa-square-o fa-stack-2x"></i>
                                                            <i class="fa fa-image fa-stack-1x"></i>
                                                        </span>
                                                        @localizzatore["Immagini"]:<i role="button" class="fa fa-close fa-pull-right text-white" data-dismiss="modal"></i>
                                                    </h3>
                                                </div>
                                                <div class="panel-body text-primary">

                                                    <div id="links">
                                                        @foreach (var immagine in Model.Immagini)
                                                        {
                                                            <a href="~/@(_opzioni_immagini.PercorsoUpload + "/" + immagine.Id + "_" + immagine.URL)"
                                                               data-didascalia="@immagine.Didascalia"
                                                               data-idImmagine="@immagine.Id"></a>
                                                        }
                                                    </div>

                                                    <div id="blueimp-gallery-carousel" class="blueimp-gallery blueimp-gallery-carousel blueimp-gallery-controls">
                                                        <div class="slides"></div>
                                                        <h3 class="title"></h3>
                                                        <p class="didascalia"></p>
                                                        <a class="prev">‹</a>
                                                        <a class="next">›</a>
                                                        <a class="play-pause"></a>
                                                        <ol class="indicator"></ol>
                                                    </div>

                                                    <p class="text-primary" id="didascaliaImmagine"></p>

                                                    @if (await autorizzatore.AuthorizeAsync(User, "EditImmagini"))
                                                    {
                                                        <div>
                                                            <span class="pull-right" ng-show="vm.visualizzaConfermaCancellazioneImmagine">
                                                                <button class="btn btn-danger"
                                                                        ng-click="vm.cancellaImmagine()">
                                                                    <i class="fa fa-trash"></i>&nbsp;@localizzatore["Conferma la cancellazione"]
                                                                </button>
                                                                <button class="btn btn-outline-secondary"
                                                                        ng-click="vm.annullaCancellazioneImmagine()">
                                                                    @localizzatore["Annulla"]
                                                                    </button>
                                                                </span>
                                                                <button class="btn btn-danger pull-right"
                                                                        ng-hide="vm.visualizzaConfermaCancellazioneImmagine"
                                                                        ng-click="vm.clickCancellaImmagine()">
                                                                    <i class="fa fa-trash"></i>&nbsp;@localizzatore["Cancella Immagine"]
                                                                </button>
                                                            </div>
                                                    }


                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <!--#endregion -->


                            <div class="col-lg-12">
                                @if (ViewBag.trovato)
                                { <text>&nbsp;&nbsp;</text>
                                    @if (await autorizzatore.AuthorizeAsync(User, "CancellazioneEsemplare"))
                                    {
                                        <button class="btn btn-danger" data-toggle="modal" data-target="#modaleConfermaCancellazione">
                                            <i class="fa fa-trash"></i>&nbsp;@localizzatore["Cancella Esemplare"]
                                        </button>

                                    }
                                    @if (await autorizzatore.AuthorizeAsync(User, "VisualizzaQRCodeScheda"))
                                    {
                                        <div class="btn-group" role="group">
                                            <button type="button"
                                                    class="btn btn-success dropdown-toggle"
                                                    data-toggle="dropdown"
                                                    aria-haspopup="true"
                                                    aria-expanded="false">
                                                <i class="fa fa-qrcode text-white"></i>&nbsp;@localizzatore["QRCode"]
                                            </button>
                                            <div class="dropdown-menu">
                                                @for (int i = 0; i < _opzioni.Formati.Count; i++)
                                                {
                                                    <a class="dropdown-item"
                                                       target="_blank"
                                                       asp-controller="QRCode"
                                                       asp-action="QRCodeScheda"
                                                       asp-route-id="@Model.Id"
                                                       asp-route-formato="@i">@localizzatore[_opzioni.Formati[i].Misura]</a>
                                                }
                                            </div>
                                        </div>
                                    }
                                    @if (await autorizzatore.AuthorizeAsync(User, "EditImmagini"))
                                    {
                                        <button type="button"
                                                class="btn btn-secondary"
                                                data-toggle="modal"
                                                data-target="#modaleUploadImmagini"
                                                ng-click="vm.apriModaleUploadImmagini()">
                                            <i class="fa fa-upload"></i>&nbsp;@localizzatore["Carica Immagini"]
                                        </button>
                                    }
                                    @if ((await autorizzatore.AuthorizeAsync(User, "VisualizzaImmagini")) && (Model.Immagini.Count > 0))
                                    {
                                        <button type="button"
                                                class="btn btn-info"
                                                data-toggle="modal"
                                                data-target="#modaleVisualizzaImmagini">
                                            <i class="fa fa-image"></i>&nbsp;@localizzatore["Immagini"] (@Model.Immagini.Count)
                                        </button>
                                    }
                                }
                            </div>
                        </div>
                    }
                    else
                    {
                        <div class="col-lg-10">
                            <h4>@localizzatore["Codice MSNG non presente!"]</h4>
                        </div>
                    }
                </div>
            </div>

            @if (ViewBag.trovato)
            {
                <div class="panel-body" style="max-height: 80vh; overflow-y: hidden">

                    <div class="row">
                        <dl class="col-lg-3 dl-horizontal text-primary">
                            <dt>
                                <a asp-controller="UpdateDettaglioEsemplare" asp-action="TogglePresenza" asp-route-id="@Model.Id" style="text-decoration:none">
                                    @if (await autorizzatore.AuthorizeAsync(User, "ModificaPresenzaEsemplare"))
                                    {
                                        @if ((bool)Model.Presenza)
                                        {
                                            <i role="button" class="fa fa-toggle-off text-muted"></i>
                                        }
                                        else
                                        {
                                            <i role="button" class="fa fa-toggle-on text-muted"></i>
                                        }
                                    }
                                </a>&nbsp;@localizzatore["Presenza"]:
                            </dt>
                            <dd>@((bool)Model.Presenza ? localizzatore["Sì"] : localizzatore["No"])</dd>

                            <div class="card card-outline-secondary" ng-controller="modaleDatiGeneraliController as vm">
                                <!-- #region modaleDatiGenerali -->
                                <div class="modal fade" id="modaleDatiGenerali" role="dialog">
                                    <div class="modal-dialog modal-lg">
                                        <div class="modal-content">
                                            <div class="modal-body">
                                                <div class="panel panel-primary">
                                                    <div class="panel-heading">
                                                        <h3 class="panel-title">@localizzatore["Inserire i nuovi valori"]:<i role="button" class="fa fa-close fa-pull-right text-white" data-dismiss="modal"></i></h3>
                                                    </div>
                                                    <div class="panel-body">
                                                        <form class="form-horizontal"
                                                              asp-controller="UpdateDettaglioEsemplare"
                                                              asp-action="AggiornaDatiGenerali"
                                                              id="formDatiGenerali"
                                                              name="formDatiGenerali">
                                                            <fieldset>

                                                                <input type="hidden" id="esemplarehiddenDatiGenerali" asp-for="Id" value="@Model.Id" />

                                                                <div class="form-group">
                                                                    <label for="uiselectSesso" class="col-lg-5 control-label">@localizzatore["Sesso"]:</label>
                                                                    <div class="col-lg-4">
                                                                        @*Questo serve per memorizzare il valore dal modello e inizializzare la dropdown all'apertura*@
                                                                        <input type="hidden" id="hiddenIdSessoSelezionato" name="hiddenIdSessoSelezionato" value="@Model.SessoId" />

                                                                        @*Questo invece serve per inviare il valore corrente al form durante il submit*@
                                                                        <input type="hidden" id="hiddenOutputIdSessoSelezionato" name="hiddenOutputIdSessoSelezionato" />

                                                                        <ui-select id="uiselectSesso" ng-model="vm.sessoSelezionato" ng-change="vm.selezionaSesso()">
                                                                            <ui-select-match>
                                                                                <span ng-bind="$select.selected.sessoLocalizzato"></span>
                                                                            </ui-select-match>
                                                                            <ui-select-choices repeat="sesso in (vm.sessi | filter: $select.search) track by sesso.id">
                                                                                <span ng-bind="sesso.sessoLocalizzato"></span>
                                                                            </ui-select-choices>
                                                                        </ui-select>
                                                                    </div>
                                                                </div>
                                                                <div class="form-group">
                                                                    <label for="inputLettera" class="col-lg-5 control-label">@localizzatore["Lettera"]:</label>
                                                                    <div class="col-lg-4">
                                                                        <input id="inputLettera" name="inputLettera" type="text" />
                                                                    </div>
                                                                </div>
                                                                <div class="form-group">
                                                                    <label for="inputNumero" class="col-lg-5 control-label">@localizzatore["Numero"]:</label>
                                                                    <div class="col-lg-4">
                                                                        <input id="inputNumero" name="inputNumero" type="text" />
                                                                    </div>
                                                                </div>
                                                                <div class="form-group">
                                                                    <label for="uiselectTipo" class="col-lg-5 control-label">@localizzatore["Tipo"]:</label>
                                                                    <div class="col-lg-4">
                                                                        @*Questo serve per memorizzare il valore dal modello e inizializzare la dropdown all'apertura*@
                                                                        <input type="hidden" id="hiddenIdTipoSelezionato" name="hiddenIdTipoSelezionato" value="@Model.TipoId" />

                                                                        @*Questo invece serve per inviare il valore corrente al form durante il submit*@
                                                                        <input type="hidden" id="hiddenOutputIdTipoSelezionato" name="hiddenOutputIdTipoSelezionato" />
                                                                        <ui-select id="uiselectTipo" ng-model="vm.tipoSelezionato" ng-change="vm.selezionaTipo()">
                                                                            <ui-select-match>
                                                                                <span ng-bind="$select.selected.tipoLocalizzato"></span>
                                                                            </ui-select-match>
                                                                            <ui-select-choices repeat="tipo in (vm.tipi | filter: $select.search) track by tipo.id">
                                                                                <span ng-bind="tipo.tipoLocalizzato"></span>
                                                                            </ui-select-choices>
                                                                        </ui-select>
                                                                    </div>
                                                                </div>
                                                                <div class="form-group">
                                                                    <label for="uiselectAberrazione" class="col-lg-5 control-label">@localizzatore["Aberrazione"]:</label>
                                                                    <div class="col-lg-4">
                                                                        @*Questo serve per memorizzare il valore dal modello e inizializzare la dropdown all'apertura*@
                                                                        <input type="hidden" id="hiddenIdAberrazioneSelezionata" name="hiddenIdAberrazioneSelezionata" value="@Model.AberrazioneId" />

                                                                        @*Questo invece serve per inviare il valore corrente al form durante il submit*@
                                                                        <input type="hidden" id="hiddenOutputIdAberrazioneSelezionata" name="hiddenOutputIdAberrazioneSelezionata" />
                                                                        <ui-select id="uiselectAberrazione" ng-model="vm.aberrazioneSelezionata" ng-change="vm.selezionaAberrazione()">
                                                                            <ui-select-match>
                                                                                <span ng-bind="$select.selected.aberrazioneLocalizzata"></span>
                                                                            </ui-select-match>
                                                                            <ui-select-choices repeat="aberrazione in (vm.aberrazioni | filter: $select.search) track by aberrazione.id">
                                                                                <span ng-bind="aberrazione.aberrazioneLocalizzata"></span>
                                                                            </ui-select-choices>
                                                                        </ui-select>
                                                                    </div>
                                                                </div>

                                                                <div class="form-group">
                                                                    <label for="inputNoteAberrazione" class="col-lg-4 control-label">@localizzatore["Note dell'Aberrazione"]:</label>
                                                                    <div class="col-lg-6">
                                                                        <textarea class="form-control" rows="3" id="inputNoteAberrazione" name="inputNoteAberrazione">@Model.NoteAberrazione</textarea>
                                                                    </div>
                                                                </div>

                                                                <div class="form-group">
                                                                    <div class="col-lg-12">
                                                                        <div class="pull-right">
                                                                            <button type="reset" class="btn btn-outline-primary" data-dismiss="modal">@localizzatore["Annulla"]</button>
                                                                            <button id="bottoneSubmitMorfologia" type="submit" class="btn btn-success">@localizzatore["Inserisci"]</button>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                            </fieldset>
                                                        </form>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <!-- #endregion -->
                                <dt>
                                    @if (await autorizzatore.AuthorizeAsync(User, "ModificaDatiGeneraliEsemplare"))
                                    {
                                        <i role="button"
                                           class="fa fa-pencil fa-pull-left fa-fw text-muted"
                                           data-toggle="modal"
                                           data-target="#modaleDatiGenerali"
                                           ng-click="vm.apriModaleDatiGenerali()"></i>
                                    }
                                    @localizzatore["Sesso"]:
                                </dt>
                                <dd>@localizzatore[Model.Sesso.Sesso]</dd>
                                <dt>@localizzatore["Lettera"]:</dt>
                                <dd>@Model.LetteraEsemplare</dd>
                                <dt>@localizzatore["Numero"]:</dt>
                                <dd>@Model.NumeroEsemplare</dd>
                                <dt>@localizzatore["Tipo"]:</dt>
                                <dd>@localizzatore[Model.Tipo.Tipo]</dd>
                                <dt>@localizzatore["Aberrazione"]:</dt>
                                <dd>@localizzatore[Model.Aberrazione.Aberrazione]</dd>
                                <dt>@localizzatore["Note dell'Aberrazione"]:</dt>
                                <dd>
                                    <textarea rows="3" readonly style="resize:none; border:none;">@Model.NoteAberrazione</textarea>
                                </dd>
                            </div>
                        </dl>

                        <dl class="col-lg-3 dl-horizontal text-primary">

                            <div class="card card-outline-secondary" ng-controller="modaleGeografiaController as vm">
                                <!-- #region modaleGeografia -->
                                <div class="modal fade" id="modaleGeografia" role="dialog">
                                    <div class="modal-dialog modal-lg">
                                        <div class="modal-content">
                                            <div class="modal-body">

                                                <div class="panel panel-primary">
                                                    <div class="panel-heading">
                                                        <h3 class="panel-title">@localizzatore["Inserire i nuovi valori"]:<i role="button" class="fa fa-close fa-pull-right text-white" data-dismiss="modal"></i></h3>
                                                    </div>
                                                    <div class="panel-body">

                                                        <form class="form-horizontal"
                                                              asp-controller="UpdateDettaglioEsemplare"
                                                              asp-action="AggiornaGeografia"
                                                              id="formGeografia"
                                                              name="formGeografia">
                                                            <fieldset>
                                                                <ul class="nav nav-tabs">
                                                                    <li class="active"><a href="#tablocalita" data-toggle="tab">@localizzatore["Località di Cattura"]</a></li>
                                                                    <li class=""><a href="#tabdata" data-toggle="tab">@localizzatore["Data di Cattura"]</a></li>
                                                                    <li class=""><a href="#tabacquisizione" data-toggle="tab">@localizzatore["Acquisizione"]</a></li>
                                                                    <li class=""><a href="#tabcollezione" data-toggle="tab">@localizzatore["Collezione"] - @localizzatore["Spedizione"]</a></li>
                                                                    <li class=""><a href="#tabreferenti" data-toggle="tab">@localizzatore["Raccoglitori"]</a></li>
                                                                </ul>
                                                                <input type="hidden" id="esemplarehiddenGeografia" asp-for="Id" value="@Model.Id" />

                                                                <div id="myTabContent" class="tab-content">

                                                                    <div class="tab-pane fade active in col-lg-offset-3" id="tablocalita">
                                                                        <div class="form-group">
                                                                            <label for="uiselectNazione" class="col-lg-3 control-label">@localizzatore["Nazione"]:</label>
                                                                            <div class="col-lg-4">
                                                                                <ui-select id="uiselectNazione" ng-model="vm.nazioneSelezionata" ng-change="vm.selezionaNazione()">
                                                                                    <ui-select-match>
                                                                                        <span ng-bind="$select.selected.nazione"></span>
                                                                                    </ui-select-match>
                                                                                    <ui-select-choices repeat="nazione in (vm.nazioni | filter: $select.search) track by nazione.id">
                                                                                        <span ng-bind="nazione.nazione"></span>
                                                                                    </ui-select-choices>
                                                                                </ui-select>
                                                                            </div>
                                                                        </div>
                                                                        <div class="form-group">
                                                                            <label for="uiselectRegione" class="col-lg-3 control-label">@localizzatore["Regione"]:</label>
                                                                            <div class="col-lg-4">
                                                                                <ui-select id="uiselectRegione" ng-model="vm.regioneSelezionata" ng-change="vm.selezionaRegione()">
                                                                                    <ui-select-match>
                                                                                        <span ng-bind="$select.selected.regione"></span>
                                                                                    </ui-select-match>
                                                                                    <ui-select-choices repeat="regione in (vm.regioni | filter: $select.search) track by regione.id">
                                                                                        <span ng-bind="regione.regione"></span>
                                                                                    </ui-select-choices>
                                                                                </ui-select>
                                                                            </div>
                                                                        </div>
                                                                        <div class="form-group">
                                                                            <label for="uiselectProvincia" class="col-lg-3 control-label">@localizzatore["Provincia"]:</label>
                                                                            <div class="col-lg-4">
                                                                                <ui-select id="uiselectProvincia" ng-model="vm.provinciaSelezionata" ng-change="vm.selezionaProvincia()">
                                                                                    <ui-select-match>
                                                                                        <span ng-bind="$select.selected.provincia"></span>
                                                                                    </ui-select-match>
                                                                                    <ui-select-choices repeat="provincia in (vm.province | filter: $select.search) track by provincia.id">
                                                                                        <span ng-bind="provincia.provincia"></span>
                                                                                    </ui-select-choices>
                                                                                </ui-select>
                                                                            </div>
                                                                        </div>
                                                                        <div class="form-group">
                                                                            <label for="uiselectCitta" class="col-lg-3 control-label">@localizzatore["Città"]:</label>
                                                                            <div class="col-lg-4">
                                                                                <ui-select id="uiselectCitta" ng-model="vm.cittaSelezionata" ng-change="vm.selezionaCitta()">
                                                                                    <ui-select-match>
                                                                                        <span ng-bind="$select.selected.nomeCitta"></span>
                                                                                    </ui-select-match>
                                                                                    <ui-select-choices repeat="citta in (vm.citta | filter: $select.search) track by citta.id">
                                                                                        <span ng-bind="citta.nomeCitta"></span>
                                                                                    </ui-select-choices>
                                                                                </ui-select>
                                                                            </div>
                                                                        </div>
                                                                        <div class="form-group">
                                                                            <label for="uiselectLocalita" class="col-lg-3 control-label">@localizzatore["Località"]:</label>
                                                                            <div class="col-lg-4">
                                                                                @*Questo serve per memorizzare il valore dal modello e inizializzare la dropdown all'apertura*@
                                                                                <input type="hidden" id="hiddenIdLocalitaSelezionata" name="hiddenIdLocalitaSelezionata" value="@Model.LocalitaCatturaId" />

                                                                                @*Questo invece serve per inviare il valore corrente al form durante il submit*@
                                                                                <input type="hidden" id="hiddenOutputIdLocalitaSelezionata" name="hiddenOutputIdLocalitaSelezionata" />

                                                                                <ui-select id="uiselectLocalita" name="uiselectLocalita" ng-model="vm.localitaSelezionata" ng-change="vm.selezionaLocalita()">
                                                                                    <ui-select-match>
                                                                                        <span ng-bind="$select.selected.nomeLocalita"></span>
                                                                                    </ui-select-match>
                                                                                    <ui-select-choices repeat="localita in (vm.localita | filter: $select.search) track by localita.id">
                                                                                        <span ng-bind="localita.nomeLocalita"></span>
                                                                                    </ui-select-choices>
                                                                                </ui-select>
                                                                            </div>
                                                                        </div>
                                                                    </div>

                                                                    <div class="tab-pane fade col-lg-offset-2" id="tabdata">
                                                                        <div class="form-group">
                                                                            <label for="inputDataCattura" class="col-lg-3 control-label">@localizzatore["Data di Cattura"]:</label>
                                                                            <div class="col-lg-4">
                                                                                <input type="hidden" id="hiddenDataCattura" value="@Model.DataCattura" />
                                                                                <input id="inputDataCattura"
                                                                                       name="inputDataCattura"
                                                                                       ng-model="vm.dataCattura"
                                                                                       type="date"
                                                                                       class="form-control">
                                                                            </div>
                                                                            <div>
                                                                                <input type="radio" name="tipoDataCattura" ng-model="vm.tipoDataCattura" value="Data completa" />
                                                                                <input type="radio" name="tipoDataCattura" ng-model="vm.tipoDataCattura" value="Ignora mese/giorno" />
                                                                                <input type="radio" name="tipoDataCattura" ng-model="vm.tipoDataCattura" value="Ignora giorno" />
                                                                                <span role="button"
                                                                                      ng-show="vm.tipoDataCattura == 'Data completa'"
                                                                                      ng-click="vm.tipoDataCattura = 'Ignora mese/giorno'">@localizzatore["Data completa"]</span>
                                                                                    <span role="button"
                                                                                          ng-show="vm.tipoDataCattura == 'Ignora mese/giorno'"
                                                                                          ng-click="vm.tipoDataCattura = 'Ignora giorno'">@localizzatore["Ignora mese/giorno"]</span>
                                                                                        <span role="button"
                                                                                              ng-show="vm.tipoDataCattura == 'Ignora giorno'"
                                                                                              ng-click="vm.tipoDataCattura = 'Data completa'">@localizzatore["Ignora giorno"]</span>
                                                                                        </div>
                                                                                    </div>
                                                                                    <div class="form-group">
                                                                                        <label for="inputDataCatturaCorretta" class="col-lg-3 control-label">@localizzatore["Data Corretta"]:</label>
                                                                                        <div class="col-lg-4">
                                                                                            <input id="inputDataCatturaCorretta"
                                                                                                   name="inputDataCatturaCorretta"
                                                                                                   type="text"
                                                                                                   class="form-control"
                                                                                                   value="@Model.DataCatturaCorretta">
                                                                                        </div>
                                                                                    </div>
                                                                                </div>

                                                                                <div class="tab-pane fade col-lg-offset-2" id="tabacquisizione">
                                                                                    <div class="form-group">
                                                                                        <label for="uiselectTipoAcquisizione" class="col-lg-4 control-label">@localizzatore["Tipo Acquisizione"]:</label>
                                                                                        <div class="col-lg-3">

                                                                                            @*Questo serve per memorizzare il valore dal modello e inizializzare la dropdown all'apertura*@
                                                                                            <input type="hidden" id="hiddenIdTipoAcquisizione" name="hiddenIdTipoAcquisizione" value="@Model.TipoAcquisizioneId" />

                                                                                            @*Questo invece serve per inviare il valore corrente al form durante il submit*@
                                                                                            <input type="hidden" id="hiddenOutputIdTipoAcquisizione" name="hiddenOutputIdTipoAcquisizione" />

                                                                                            <ui-select id="uiselectTipoAcquisizione" ng-model="vm.TipoAcquisizioneSelezionato" ng-change="vm.selezionaTipoAcquisizione()">
                                                                                                <ui-select-match>
                                                                                                    <span ng-bind="$select.selected.tipoAcquisizioneLocalizzato"></span>
                                                                                                </ui-select-match>
                                                                                                <ui-select-choices repeat="tipoAcquisizione in (vm.tipiAcquisizione | filter: $select.search) track by tipoAcquisizione.id">
                                                                                                    <span ng-bind="tipoAcquisizione.tipoAcquisizioneLocalizzato"></span>
                                                                                                </ui-select-choices>
                                                                                            </ui-select>
                                                                                        </div>
                                                                                    </div>
                                                                                    <div class="form-group">
                                                                                        <label for="inputDataAcquisizione" class="col-lg-3 control-label">@localizzatore["Data Acquisizione"]:</label>
                                                                                        <div class="col-lg-4">
                                                                                            <input type="hidden" id="hiddenDataAcquisizione" value="@Model.DataAcquisizione" />
                                                                                            <input id="inputDataAcquisizione"
                                                                                                   name="inputDataAcquisizione"
                                                                                                   type="date"
                                                                                                   class="form-control">
                                                                                        </div>
                                                                                        <div>
                                                                                            <input type="radio" name="tipoDataAcquisizione" ng-model="vm.tipoDataAcquisizione" value="Data completa" />
                                                                                            <input type="radio" name="tipoDataAcquisizione" ng-model="vm.tipoDataAcquisizione" value="Ignora mese/giorno" />
                                                                                            <input type="radio" name="tipoDataAcquisizione" ng-model="vm.tipoDataAcquisizione" value="Ignora giorno" />
                                                                                            <span role="button"
                                                                                                  ng-show="vm.tipoDataAcquisizione == 'Data completa'"
                                                                                                  ng-click="vm.tipoDataAcquisizione = 'Ignora mese/giorno'">@localizzatore["Data completa"]</span>
                                                                                                <span role="button"
                                                                                                      ng-show="vm.tipoDataAcquisizione == 'Ignora mese/giorno'"
                                                                                                      ng-click="vm.tipoDataAcquisizione == 'Ignora giorno'">@localizzatore["Ignora mese/giorno"]</span>
                                                                                                    <span role="button"
                                                                                                          ng-show="vm.tipoDataAcquisizione == 'Ignora giorno'"
                                                                                                          ng-click="vm.tipoDataAcquisizione = 'Data completa'">@localizzatore["Ignora giorno"]</span>
                                                                                                    </div>
                                                                                                </div>
                                                                                            </div>

                                                                                            <div class="tab-pane fade col-lg-offset-2" id="tabcollezione">

                                                                                                <div class="form-group">
                                                                                                    <label for="uiselectCollezione" class="col-lg-3 control-label">@localizzatore["Collezione"]:</label>
                                                                                                    <div class="col-lg-7">

                                                                                                        @*Questo serve per memorizzare il valore dal modello e inizializzare la dropdown all'apertura*@
                                                                                                        <input type="hidden" id="hiddenIdCollezione" value="@Model.CollezioneId" />

                                                                                                        @*Questo invece serve per inviare il valore corrente al form durante il submit*@
                                                                                                        <input type="hidden" id="hiddenOutputIdCollezione" name="hiddenOutputIdCollezione" />

                                                                                                        <ui-select id="uiselectCollezione" ng-model="vm.CollezioneSelezionata" ng-change="vm.selezionaCollezione()">
                                                                                                            <ui-select-match>
                                                                                                                <span ng-bind="$select.selected.collezione"></span>
                                                                                                            </ui-select-match>
                                                                                                            <ui-select-choices repeat="collezione in (vm.collezioni | filter: $select.search) track by collezione.id">
                                                                                                                <span ng-bind="collezione.collezione"></span>
                                                                                                            </ui-select-choices>
                                                                                                        </ui-select>
                                                                                                    </div>
                                                                                                </div>
                                                                                                <div class="form-group">
                                                                                                    <label for="uiselectSpedizione" class="col-lg-3 control-label">@localizzatore["Spedizione"]:</label>
                                                                                                    <div class="col-lg-7">

                                                                                                        @*Questo serve per memorizzare il valore dal modello e inizializzare la dropdown all'apertura*@
                                                                                                        <input type="hidden" id="hiddenIdSpedizione" value="@Model.SpedizioneId" />

                                                                                                        @*Questo invece serve per inviare il valore corrente al form durante il submit*@
                                                                                                        <input type="hidden" id="hiddenoutputIdSpedizione" name="hiddenoutputIdSpedizione" />

                                                                                                        <ui-select id="uiselectSpedizione" ng-model="vm.SpedizioneSelezionata" ng-change="vm.selezionaSpedizione()">
                                                                                                            <ui-select-match>
                                                                                                                <span ng-bind="$select.selected.spedizione"></span>
                                                                                                            </ui-select-match>
                                                                                                            <ui-select-choices repeat="spedizione in (vm.spedizioni | filter: $select.search) track by spedizione.id">
                                                                                                                <span ng-bind="spedizione.spedizione"></span>
                                                                                                            </ui-select-choices>
                                                                                                        </ui-select>
                                                                                                    </div>
                                                                                                </div>
                                                                                            </div>

                                                                                            <div class="tab-pane fade col-lg-offset-3" id="tabreferenti">
                                                                                                <div class="form-group">
                                                                                                    <label for="uiselectAvutoDa" class="col-lg-3 control-label">@localizzatore["Avuto da"]:</label>
                                                                                                    <div class="col-lg-7">

                                                                                                        @*Questo serve per memorizzare il valore dal modello e inizializzare la dropdown all'apertura*@
                                                                                                        <input type="hidden" id="hiddenIdAvutoDa" value="@Model.AvutoDaId" />

                                                                                                        @*Questo invece serve per inviare il valore corrente al form durante il submit*@
                                                                                                        <input type="hidden" id="hiddenOutputIdAvutoDa" name="hiddenOutputIdAvutoDa" />

                                                                                                        <ui-select id="uiselectAvutoDa" ng-model="vm.AvutoDaSelezionato" ng-change="vm.selezionaAvutoDa()">
                                                                                                            <ui-select-match>
                                                                                                                <span ng-bind="$select.selected.raccoglitore"></span>
                                                                                                            </ui-select-match>
                                                                                                            <ui-select-choices repeat="raccoglitore in (vm.raccoglitori | filter: $select.search) track by raccoglitore.id">
                                                                                                                <span ng-bind="raccoglitore.raccoglitore"></span>
                                                                                                            </ui-select-choices>
                                                                                                        </ui-select>
                                                                                                    </div>
                                                                                                </div>
                                                                                                <div class="form-group">
                                                                                                    <label for="uiselectLegit" class="col-lg-3 control-label">@localizzatore["Legit"]:</label>
                                                                                                    <div class="col-lg-7">

                                                                                                        @*Questo serve per memorizzare il valore dal modello e inizializzare la dropdown all'apertura*@
                                                                                                        <input type="hidden" id="hiddenIdLegit" value="@Model.LegitId" />

                                                                                                        @*Questo invece serve per inviare il valore corrente al form durante il submit*@
                                                                                                        <input type="hidden" id="hiddenOutputIdLegit" name="hiddenOutputIdLegit" />

                                                                                                        <ui-select id="uiselectLegit" ng-model="vm.LegitSelezionato" ng-change="vm.selezionaLegit()">
                                                                                                            <ui-select-match>
                                                                                                                <span ng-bind="$select.selected.raccoglitore"></span>
                                                                                                            </ui-select-match>
                                                                                                            <ui-select-choices repeat="raccoglitore in (vm.raccoglitori | filter: $select.search) track by raccoglitore.id">
                                                                                                                <span ng-bind="raccoglitore.raccoglitore"></span>
                                                                                                            </ui-select-choices>
                                                                                                        </ui-select>
                                                                                                    </div>
                                                                                                </div>
                                                                                                <div class="form-group">
                                                                                                    <label for="uiselectCedente" class="col-lg-3 control-label">@localizzatore["Cedente"]:</label>
                                                                                                    <div class="col-lg-7">

                                                                                                        @*Questo serve per memorizzare il valore dal modello e inizializzare la dropdown all'apertura*@
                                                                                                        <input type="hidden" id="hiddenIdCedente" value="@Model.CedenteId" />

                                                                                                        @*Questo invece serve per inviare il valore corrente al form durante il submit*@
                                                                                                        <input type="hidden" id="hiddenOutputIdCedente" name="hiddenOutputIdCedente" />

                                                                                                        <ui-select id="uiselectCedente" ng-model="vm.CedenteSelezionato" ng-change="vm.selezionaCedente()">
                                                                                                            <ui-select-match>
                                                                                                                <span ng-bind="$select.selected.raccoglitore"></span>
                                                                                                            </ui-select-match>
                                                                                                            <ui-select-choices repeat="raccoglitore in (vm.raccoglitori | filter: $select.search) track by raccoglitore.id">
                                                                                                                <span ng-bind="raccoglitore.raccoglitore"></span>
                                                                                                            </ui-select-choices>
                                                                                                        </ui-select>
                                                                                                    </div>
                                                                                                </div>
                                                                                            </div>
                                                                                        </div>
                                                                                        <br />
                                                                                        <div class="form-group">
                                                                                            <div class="col-lg-12">
                                                                                                <div class="pull-right">
                                                                                                    <button type="reset" class="btn btn-outline-primary" data-dismiss="modal">@localizzatore["Annulla"]</button>
                                                                                                    <button id="bottoneSubmitMorfologia" type="submit" class="btn btn-success">@localizzatore["Inserisci"]</button>
                                                                                                </div>
                                                                                            </div>
                                                                                        </div>
                                                                                    </fieldset>
                                                                                </form>
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <!-- #endregion -->
                                                        <dt>
                                                            @if (await autorizzatore.AuthorizeAsync(User, "ModificaDatiGeografiaEsemplare"))
                                                            {
                                                                <i role="button"
                                                                   class="fa fa-pencil fa-pull-left fa-fw text-muted"
                                                                   data-toggle="modal"
                                                                   data-target="#modaleGeografia"
                                                                   ng-click="vm.apriModaleGeografia();"></i>
                                                            }
                                                            @localizzatore["Località di Cattura"]:
                                                        </dt>

                                                        @*
                                                            I parametri del dd servono per far comparire il popover di localizzazione geografica cliccando sulla località. tabindex=0 è un workaround per un bug di Bootstrap
                                                            altrimenti data-trigger=focus non funzionebbe. Mettere tabindex obbliga anche ad aggiungere style=outline:none altrimenti si vedrebbe
                                                            una antiestetica cornice attorno all'elemento. data-html=true è importante perché c'è codice html all'interno del data-content.
                                                            La serie di if-elseif visualizza il primo elemento "non-trattino" nella localizzazione geografica (il più dettagliato).
                                                        *@
                                                        <input type="hidden" id="hiddenIdLocalita" value="@Model.LocalitaCatturaId" />
                                                        <dd data-toggle="popover"
                                                            data-html="true"
                                                            data-placement="bottom"
                                                            tabindex="0"
                                                            data-trigger="focus"
                                                            style="outline:none;cursor:pointer;"
                                                            data-content="@localizzatore["Nazione"]: <b>@(Model.LocalitaCattura.Citta.Provincia.Regione.Nazione.Nazione)</b><br>
                                          @localizzatore["Regione"]: <b>@(Model.LocalitaCattura.Citta.Provincia.Regione.Regione)</b><br>
                                          @localizzatore["Provincia"]: <b>@(Model.LocalitaCattura.Citta.Provincia.Provincia)</b><br>
                                          @localizzatore["Città"]: <b>@(Model.LocalitaCattura.Citta.NomeCitta)</b><br>
                                          @localizzatore["Località"]: <b>@(Model.LocalitaCattura.NomeLocalita)</b>">
                                        @{
                                            if (Model.LocalitaCattura.Citta.Provincia.Regione.Regione == "-")
                                            {
                                                @Model.LocalitaCattura.Citta.Provincia.Regione.Nazione.Nazione
                                            }
                                            else if (Model.LocalitaCattura.Citta.Provincia.Provincia == "-")
                                            {
                                                @Model.LocalitaCattura.Citta.Provincia.Regione.Regione
                                            }
                                            else if (Model.LocalitaCattura.Citta.NomeCitta == "-")
                                            {
                                                @Model.LocalitaCattura.Citta.Provincia.Provincia
                                            }
                                            else if (Model.LocalitaCattura.NomeLocalita == "-")
                                            {
                                                @Model.LocalitaCattura.Citta.NomeCitta
                                            }
                                            else
                                            {
                                                @Model.LocalitaCattura.NomeLocalita
                                            }
                                        }
                                </dd>

                                                        <dt>@localizzatore["Data di Cattura"]:</dt>
                                                        <dd>@funzioni.leggiData(Model.DataCattura)</dd>
                                                        <dt>@localizzatore["Data Corretta"]:</dt>
                                                        <dd>@Model.DataCatturaCorretta</dd>
                                                        <dt>@localizzatore["Tipo Acquisizione"]:</dt>
                                                        <dd>@localizzatore[Model.TipoAcquisizione.TipoAcquisizione]</dd>
                                                        <dt>@localizzatore["Data Acquisizione"]:</dt>
                                                        <dd>@funzioni.leggiData(Model.DataAcquisizione)</dd>
                                                        <dt>@localizzatore["Collezione"]:</dt>
                                                        <dd>@Model.Collezione.Collezione</dd>
                                                        <dt>@localizzatore["Spedizione"]:</dt>
                                                        <dd>@Model.Spedizione.Spedizione</dd>
                                                        <dt>@localizzatore["Avuto da"]:</dt>
                                                        <dd>@Model.AvutoDa.Raccoglitore</dd>
                                                        <dt>@localizzatore["Legit"]:</dt>
                                                        <dd>@Model.Legit.Raccoglitore</dd>
                                                        <dt>@localizzatore["Cedente"]:</dt>
                                                        <dd>@Model.Cedente.Raccoglitore</dd>
                                                    </div>
                                                </dl>

                                                <dl class="col-lg-3 dl-horizontal text-primary">
                                                    <div class="card card-outline-secondary" ng-controller="modaleDeterminazioniController as vm">
                                                        <!-- #region modaleDeterminazioni -->
                                                        <div class="modal fade" id="modaleDeterminazioni" role="dialog">
                                                            <div class="modal-dialog modal-lg">
                                                                <div class="modal-content">
                                                                    <div class="modal-body">
                                                                        <div class="panel panel-primary">
                                                                            <div class="panel-heading">
                                                                                <h3 class="panel-title">@localizzatore["Inserire i nuovi valori"]:<i role="button" class="fa fa-close fa-pull-right text-white" data-dismiss="modal"></i></h3>
                                                                            </div>
                                                                            <div class="panel-body">
                                                                                <form class="form-horizontal"
                                                                                      asp-controller="UpdateDettaglioEsemplare"
                                                                                      asp-action="AggiornaDeterminazioni"
                                                                                      id="formDeterminazioni"
                                                                                      name="formDeterminazioni">
                                                                                    <fieldset>

                                                                                        <input type="hidden" id="esemplarehiddenDeterminazioni" asp-for="Id" value="@Model.Id" />

                                                                                        <div class="form-group">
                                                                                            <label for="inputDataDiDeterminazione" class="col-lg-4 control-label">@localizzatore["Data di Determinazione"]:</label>
                                                                                            <div class="col-lg-4">
                                                                                                <input type="hidden" id="hiddenDataDiDeterminazione" value="@Model.DataDeterminazione" />
                                                                                                <input id="inputDataDiDeterminazione"
                                                                                                       name="inputDataDiDeterminazione"
                                                                                                       ng-model="vm.dataDeterminazione"
                                                                                                       type="date"
                                                                                                       class="form-control">
                                                                                            </div>
                                                                                            <div>
                                                                                                <input type="radio" name="tipoDataDeterminazione" ng-model="vm.tipoDataDeterminazione" value="Data completa" />
                                                                                                <input type="radio" name="tipoDataDeterminazione" ng-model="vm.tipoDataDeterminazione" value="Ignora mese/giorno" />
                                                                                                <input type="radio" name="tipoDataDeterminazione" ng-model="vm.tipoDataDeterminazione" value="Ignora giorno" />
                                                                                                <span role="button"
                                                                                                      ng-show="vm.tipoDataDeterminazione == 'Data completa'"
                                                                                                      ng-click="vm.tipoDataDeterminazione = 'Ignora mese/giorno'">@localizzatore["Data completa"]</span>
                                                                                                    <span role="button"
                                                                                                          ng-show="vm.tipoDataDeterminazione == 'Ignora mese/giorno'"
                                                                                                          ng-click="vm.tipoDataDeterminazione = 'Ignora giorno'">@localizzatore["Ignora mese/giorno"]</span>
                                                                                                        <span role="button"
                                                                                                              ng-show="vm.tipoDataDeterminazione == 'Ignora giorno'"
                                                                                                              ng-click="vm.tipoDataDeterminazione = 'Data completa'">@localizzatore["Ignora giorno"]</span>
                                                                                                        </div>
                                                                                                    </div>

                                                                                                    <div class="form-group">
                                                                                                        <label for="uiselectDeterminatori" class="col-lg-4 control-label">@localizzatore["Determinatori"]:</label>
                                                                                                        <div class="col-lg-4">
                                                                                                            <ui-select id="uiselectDeterminatori" ng-model="vm.determinatoreSelezionato" ng-change="vm.selezionDeterminatore()">
                                                                                                                <ui-select-match>
                                                                                                                    <span ng-bind="$select.selected.nome + ' ' + $select.selected.cognome"></span>
                                                                                                                </ui-select-match>
                                                                                                                <ui-select-choices repeat="determinatore in (vm.determinatori | filter: $select.search) track by determinatore.id">
                                                                                                                    <span ng-bind="determinatore.nome + ' ' + determinatore.cognome"></span>
                                                                                                                </ui-select-choices>
                                                                                                            </ui-select>
                                                                                                        </div>
                                                                                                        <div class="col-lg-1">
                                                                                                            <i role="button" ng-click="vm.aggiungiDeterminatore()" class="fa fa-plus-square fa-2x text-success"></i>
                                                                                                        </div>
                                                                                                    </div>

                                                                                                    <div class="form-group">
                                                                                                        <div class="col-lg-offset-2 col-lg-8">
                                                                                                            <div style="overflow-y:auto; overflow-x:hidden; max-height:300px;">
                                                                                                                <input type="hidden" id="tabellaElencoDeterminatoriSerializzata" name="tabellaElencoDeterminatoriSerializzata" />
                                                                                                                <table datatable="ng" class="table table-striped table-bordered table-hover text-primary" id="tabellaElencoDeterminatori" dt-options="vm.opzioniTabellaElencoDeterminatori">
                                                                                                                    <thead>
                                                                                                                        <tr>
                                                                                                                            <th>@localizzatore["Ordinamento"]</th>
                                                                                                                            <th>@localizzatore["Determinatore"]</th>
                                                                                                                            <th></th>
                                                                                                                        </tr>
                                                                                                                    </thead>
                                                                                                                    <tbody>
                                                                                                                        <tr ng-repeat="determinatore in vm.datiTabellaElencoDeterminatori">
                                                                                                                            <td>{{$index+1}}</td>
                                                                                                                            <td>{{determinatore.nome + " " + determinatore.cognome}}</td>
                                                                                                                            <td>
                                                                                                                                <div class="btn-group fa-pull-right">
                                                                                                                                    <i role="button" ng-show="!$first" ng-click="vm.spostaSu($index)" class="fa fa-arrow-up fa-2x text-success"></i>
                                                                                                                                    <i role="button" ng-show="!$last" ng-click="vm.spostaGiu($index)" class="fa fa-arrow-down fa-2x text-success"></i>
                                                                                                                                    <i role="button" ng-click="vm.rimuoviDeterminatore(determinatore)" class="fa fa-minus-square fa-2x text-danger"></i>
                                                                                                                                </div>
                                                                                                                            </td>
                                                                                                                        </tr>
                                                                                                                    </tbody>
                                                                                                                </table>
                                                                                                            </div>
                                                                                                        </div>
                                                                                                    </div>

                                                                                                    <div class="form-group">
                                                                                                        <div class="col-lg-12">
                                                                                                            <div class="pull-right">
                                                                                                                <button type="reset" class="btn btn-outline-primary" data-dismiss="modal">@localizzatore["Annulla"]</button>
                                                                                                                <button id="bottoneSubmitDeterminazioni" type="submit" class="btn btn-success">@localizzatore["Inserisci"]</button>
                                                                                                            </div>
                                                                                                        </div>
                                                                                                    </div>
                                                                                                </fieldset>
                                                                                            </form>
                                                                                        </div>
                                                                                    </div>
                                                                                </div>
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                    <!-- #endregion -->
                                                                    <dt>
                                                                        @if (await autorizzatore.AuthorizeAsync(User, "ModificaDatiDeterminazioniEsemplare"))
                                                                        {
                                                                            <i role="button"
                                                                               class="fa fa-pencil fa-pull-left fa-fw text-muted"
                                                                               data-toggle="modal"
                                                                               data-target="#modaleDeterminazioni"
                                                                               ng-click="vm.apriModaleDeterminazioni()"></i>
                                                                        }
                                                                        @localizzatore["Data di Determinazione"]:
                                                                    </dt>
                                                                    <dd>@funzioni.leggiData(Model.DataDeterminazione)</dd>
                                                                    <dt>@localizzatore["Determinatori"]:</dt>
                                                                    <dd>
                                                                        <ul class="list-unstyled">
                                                                            @foreach (var determinatore in Model.Determinazioni.OrderBy(det => det.Ordinamento))
                                                                            {
                                                                                <li>@(determinatore.Determinatore.Nome + " " + determinatore.Determinatore.Cognome)</li>
                                                                            }
                                                                        </ul>
                                                                    </dd>
                                                                </div>

                                                                <div class="card card-outline-secondary" ng-controller="modaleVecchieDeterminazioniController as vm">
                                                                    <!-- #region modaleVecchieDeterminazioni -->
                                                                    <div class="modal fade" id="modaleVecchieDeterminazioni" role="dialog">
                                                                        <div class="modal-dialog modal-lg">
                                                                            <div class="modal-content">
                                                                                <div class="modal-body">
                                                                                    <div class="panel panel-primary">
                                                                                        <div class="panel-heading">
                                                                                            <h3 class="panel-title">@localizzatore["Inserire i nuovi valori"]:<i role="button" class="fa fa-close fa-pull-right text-white" data-dismiss="modal"></i></h3>
                                                                                        </div>
                                                                                        <div class="panel-body">

                                                                                            <form class="form-horizontal"
                                                                                                  asp-controller="UpdateDettaglioEsemplare"
                                                                                                  asp-action="AggiornaVecchieDeterminazioni"
                                                                                                  ng-submit="vm.serializzaTabelle()">
                                                                                                <fieldset>
                                                                                                    <input type="hidden" id="esemplarehiddenVecchieDeterminazioni" asp-for="Id" value="@Model.Id" />
                                                                                                    <input type="hidden" id="serializzazioneHiddenVecchieDeterminazioni" name="serializzazioneHiddenVecchieDeterminazioni" />
                                                                                                    <input type="hidden" id="serializzazioneHiddenVecchiDeterminatori" name="serializzazioneHiddenVecchiDeterminatori" />

                                                                                                    <div class="row">
                                                                                                        <div class="col-lg-6">
                                                                                                            <div style="overflow-y:auto; overflow-x:hidden; max-height:500px;">
                                                                                                                <table datatable="ng" class="table table-bordered  text-primary" id="tabellaVecchieDeterminazioni" dt-options="vm.opzioniTabellaVecchieDeterminazioni">
                                                                                                                    <thead>
                                                                                                                        <tr>
                                                                                                                            <th>
                                                                                                                                @localizzatore["Vecchie Determinazioni"]<br />
                                                                                                                                <input class="form-control" type="text" ng-model="vm.inputVecchiaDeterminazione" />
                                                                                                                                <br /><br />@localizzatore["Anno"]<br />
                                                                                                                                <input class="form-control"
                                                                                                                                       id="inputDataDeterminazione"
                                                                                                                                       type="number" min="1700" step="1"
                                                                                                                                       ng-model="vm.inputDataDeterminazione" />
                                                                                                                            </th>
                                                                                                                            <th><i role="button" class="fa fa-plus-square fa-2x text-success fa-pull-right" ng-click="vm.aggiungiVecchiaDeterminazione()" ng-hide="vm.duranteInserimento"></i></th>
                                                                                                                        </tr>

                                                                                                                    </thead>
                                                                                                                    <tbody>
                                                                                                                        <tr ng-repeat="vecchiaDeterminazione in vm.datiTabellaVecchieDeterminazioni">

                                                                                                                            <td ng-click="vm.selezionaRiga(vecchiaDeterminazione)">
                                                                                                                                {{(vecchiaDeterminazione.dataDeterminazione == "" ? "" : "(" + vecchiaDeterminazione.dataDeterminazione +") " ) + vecchiaDeterminazione.vecchiaDeterminazione}}
                                                                                                                            </td>
                                                                                                                            <td>
                                                                                                                                <div class="btn-group fa-pull-right">
                                                                                                                                    <i role="button"
                                                                                                                                       ng-show="!$first && (vm.duranteInserimento == 0)"
                                                                                                                                       ng-click="vm.spostaSu($index)"
                                                                                                                                       class="fa fa-arrow-up fa-2x text-success"></i>
                                                                                                                                    <i role="button"
                                                                                                                                       ng-show="!$last && (vm.duranteInserimento == 0)"
                                                                                                                                       ng-click="vm.spostaGiu($index)"
                                                                                                                                       class="fa fa-arrow-down fa-2x text-success"></i>
                                                                                                                                    <i role="button"
                                                                                                                                       ng-click="vm.rimuoviVecchiaDeterminazione($index)"
                                                                                                                                       ng-show="(vm.duranteInserimento == 0) || (vecchiaDeterminazione.id == vm.duranteInserimento)"
                                                                                                                                       class="fa fa-minus-square fa-2x text-danger"></i>
                                                                                                                                </div>
                                                                                                                            </td>
                                                                                                                        </tr>
                                                                                                                    </tbody>
                                                                                                                </table>
                                                                                                            </div>
                                                                                                        </div>
                                                                                                        <div class="col-lg-6">
                                                                                                            <div style="overflow-y:auto; overflow-x:hidden; max-height:500px;">
                                                                                                                <table datatable="ng" class="table table-striped table-bordered table-hover text-primary" id="tabellaVecchiDeterminatori" dt-options="vm.opzioniTabellaVecchiDeterminatori">
                                                                                                                    <thead>
                                                                                                                        <tr>
                                                                                                                            <th>
                                                                                                                                @localizzatore["Vecchi Determinatori"]<br />@localizzatore["per"] {{vm.vecchiaDeterminazioneSelezionata}}<br />
                                                                                                                                <select class="form-control"
                                                                                                                                        id="dropdownDeterminatori"
                                                                                                                                        name="dropdownDeterminatori"
                                                                                                                                        ng-model="vm.vecchioDeterminatoreSelezionato"
                                                                                                                                        ng-options="determinatore as (determinatore.nome + ' ' + determinatore.cognome) for determinatore in vm.dropdownVecchiDeterminatori track by determinatore.id"></select>
                                                                                                                            </th>
                                                                                                                            <th><i role="button" class="fa fa-plus-square fa-2x text-success fa-pull-right" ng-click="vm.aggiungiVecchioDeterminatore()"></i></th>
                                                                                                                        </tr>
                                                                                                                    </thead>
                                                                                                                    <tbody>
                                                                                                                        <tr ng-repeat="vecchiodeterminatore in vm.datiTabellaVecchiDeterminatori">
                                                                                                                            <td>{{vecchiodeterminatore.determinatore.nome + " " + vecchiodeterminatore.determinatore.cognome}}</td>
                                                                                                                            <td>
                                                                                                                                <div class="btn-group fa-pull-right">
                                                                                                                                    <i role="button"
                                                                                                                                       ng-show="!$first"
                                                                                                                                       ng-click="vm.spostaSuDet($index)"
                                                                                                                                       class="fa fa-arrow-up fa-2x text-success"></i>
                                                                                                                                    <i role="button"
                                                                                                                                       ng-show="!$last"
                                                                                                                                       ng-click="vm.spostaGiuDet($index)"
                                                                                                                                       class="fa fa-arrow-down fa-2x text-success"></i>
                                                                                                                                    <i role="button" ng-click="vm.rimuoviVecchioDeterminatore($index)" class="fa fa-minus-square fa-2x text-danger"></i>
                                                                                                                                </div>
                                                                                                                            </td>
                                                                                                                        </tr>
                                                                                                                    </tbody>
                                                                                                                </table>
                                                                                                            </div>
                                                                                                        </div>
                                                                                                    </div>

                                                                                                    <div class="form-group">
                                                                                                        <div class="col-lg-12">
                                                                                                            <div class="pull-right">
                                                                                                                <button type="reset" class="btn btn-outline-primary" data-dismiss="modal">@localizzatore["Annulla"]</button>
                                                                                                                <button type="submit" class="btn btn-success" ng-disabled="vm.invalido || (vm.duranteInserimento > 0)">@localizzatore["Inserisci"]</button>
                                                                                                            </div>
                                                                                                        </div>
                                                                                                    </div>
                                                                                                </fieldset>
                                                                                            </form>
                                                                                        </div>
                                                                                    </div>
                                                                                </div>
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                    <!-- #endregion -->
                                                                    <dt>
                                                                        @if (await autorizzatore.AuthorizeAsync(User, "ModificaDatiVecchieDeterminazioniEsemplare"))
                                                                        {
                                                                            <i role="button"
                                                                               class="fa fa-pencil fa-pull-left fa-fw text-muted"
                                                                               data-toggle="modal"
                                                                               data-target="#modaleVecchieDeterminazioni"
                                                                               ng-click="vm.apriModaleVecchieDeterminazioni();"></i>
                                                                        }
                                                                        @localizzatore["Vecchie Determinazioni"]:
                                                                    </dt>
                                                                    <dd style="max-height:180px;overflow-y:auto;">
                                                                        <ul class="list-unstyled">
                                                                            @foreach (var determinazione in Model.VecchieDeterminazioni.OrderBy(det => det.Ordinamento))
                                                                            {
                                                                                <li>@((String.IsNullOrWhiteSpace(determinazione.DataDeterminazione) ? "" : ("(" + determinazione.DataDeterminazione + ") ")) + determinazione.VecchiaDeterminazione)</li>
                                                                                <ol>
                                                                                    @foreach (var vecchioDeterminatore in determinazione.VecchiDeterminatori.OrderBy(det => det.Ordinamento))
                                                                                    {
                                                                                        <li>@(vecchioDeterminatore.Determinatore.Nome + " " + vecchioDeterminatore.Determinatore.Cognome)</li>
                                                                                    }
                                                                                </ol>
                                                                            }
                                                                        </ul>
                                                                    </dd>
                                                                </div>
                                                            </dl>

                                                            <dl class="col-lg-3 dl-horizontal text-primary">

                                                                <div class="card card-outline-secondary" ng-controller="modaleModiPreparazioneController as vm">
                                                                    <!-- #region modaleModiPreparazione -->
                                                                    <div class="modal fade" id="modaleModiPreparazione" role="dialog">
                                                                        <div class="modal-dialog modal-lg">
                                                                            <div class="modal-content">
                                                                                <div class="modal-body">
                                                                                    <div class="panel panel-primary">
                                                                                        <div class="panel-heading">
                                                                                            <h3 class="panel-title">@localizzatore["Inserire i nuovi valori"]:<i role="button" class="fa fa-close fa-pull-right text-white" data-dismiss="modal"></i></h3>
                                                                                        </div>
                                                                                        <div class="panel-body">

                                                                                            <form class="form-horizontal"
                                                                                                  asp-controller="UpdateDettaglioEsemplare"
                                                                                                  asp-action="AggiornaModiPreparazione">
                                                                                                <fieldset>
                                                                                                    <input type="hidden" id="esemplarehiddenElencoPreparati" asp-for="Id" value="@Model.Id" />
                                                                                                    <input type="hidden" id="tabellaElencoPreparatiSerializzata" name="tabellaElencoPreparatiSerializzata" />
                                                                                                    <div class="form-group">
                                                                                                        <div class="col-lg-12">
                                                                                                            <div style="overflow-y:auto; overflow-x:hidden; max-height:300px;">
                                                                                                                <table datatable="ng" class="table table-striped table-bordered table-hover text-primary" id="tabellaModiPreparazione" dt-options="vm.opzioniTabellaModiPreparazione">
                                                                                                                    <thead>
                                                                                                                        <tr>
                                                                                                                            <th>
                                                                                                                                @localizzatore["Preparazione"]<br />
                                                                                                                                <select id="modiPreparazione"
                                                                                                                                        name="modiPreparazione"
                                                                                                                                        class="form-control"
                                                                                                                                        ng-model="vm.modoPreparazioneSelezionato"
                                                                                                                                        ng-options="preparazione as preparazione.parte for preparazione in vm.dropdownModiPreparazione track by preparazione.id"></select>
                                                                                                                            </th>
                                                                                                                            <th>
                                                                                                                                @localizzatore["Sala"]<br />
                                                                                                                                <select class="form-control"
                                                                                                                                        id="dropdownSala"
                                                                                                                                        name="dropdownSala"
                                                                                                                                        ng-model="vm.salaSelezionata"
                                                                                                                                        ng-change="vm.aggiornaDropdownArmadi()"
                                                                                                                                        ng-options="sala as sala.sala for sala in vm.dropdownSale track by sala.id"></select>
                                                                                                                            </th>
                                                                                                                            <th>
                                                                                                                                @localizzatore["Armadio"]<br />
                                                                                                                                <select class="form-control"
                                                                                                                                        id="dropdownArmadio"
                                                                                                                                        name="dropdownArmadio"
                                                                                                                                        ng-model="vm.armadioSelezionato"
                                                                                                                                        ng-change="vm.aggiornaDropdownCassetti()"
                                                                                                                                        ng-options="armadio as armadio.armadio for armadio in vm.dropdownArmadi track by armadio.id"></select>
                                                                                                                            </th>
                                                                                                                            <th>
                                                                                                                                @localizzatore["Cassetto"]<br />
                                                                                                                                <select class="form-control"
                                                                                                                                        id="dropdownCassetto"
                                                                                                                                        name="dropdownCassetto"
                                                                                                                                        ng-model="vm.cassettoSelezionato"
                                                                                                                                        ng-change="vm.aggiornaDropdownVassoi()"
                                                                                                                                        ng-options="cassetto as cassetto.cassetto for cassetto in vm.dropdownCassetti track by cassetto.id"></select>
                                                                                                                            </th>
                                                                                                                            <th>
                                                                                                                                @localizzatore["Vassoio"]<br />
                                                                                                                                <select class="form-control"
                                                                                                                                        id="dropdownVassoio"
                                                                                                                                        name="dropdownVassoio"
                                                                                                                                        ng-model="vm.vassoioSelezionato"
                                                                                                                                        ng-options="vassoio as vassoio.vassoio for vassoio in vm.dropdownVassoi track by vassoio.id"></select>
                                                                                                                            </th>
                                                                                                                            <th class="text-center"><i role="button" ng-click="vm.aggiungiPreparazione()" class="fa fa-plus-square fa-2x text-success"></i></th>
                                                                                                                        </tr>
                                                                                                                    </thead>
                                                                                                                    <tbody>
                                                                                                                        <tr ng-repeat="preparazione in vm.datiTabellaModiPreparazione">
                                                                                                                            <td>{{preparazione.parte.parte}}</td>
                                                                                                                            <td>{{preparazione.vassoio.cassetto.armadio.sala.sala}}</td>
                                                                                                                            <td>{{preparazione.vassoio.cassetto.armadio.armadio}}</td>
                                                                                                                            <td>{{preparazione.vassoio.cassetto.cassetto}}</td>
                                                                                                                            <td>{{preparazione.vassoio.vassoio}}</td>
                                                                                                                            <td>
                                                                                                                                <div class="btn-group fa-pull-right">
                                                                                                                                    <i role="button" ng-show="!$first" ng-click="vm.spostaSu($index)" class="fa fa-arrow-up fa-2x text-success"></i>
                                                                                                                                    <i role="button" ng-show="!$last" ng-click="vm.spostaGiu($index)" class="fa fa-arrow-down fa-2x text-success"></i>
                                                                                                                                    <i role="button" ng-click="vm.rimuoviPreparazione(preparazione)" class="fa fa-minus-square fa-2x text-danger"></i>
                                                                                                                                </div>
                                                                                                                            </td>
                                                                                                                        </tr>
                                                                                                                    </tbody>
                                                                                                                </table>
                                                                                                            </div>
                                                                                                        </div>
                                                                                                    </div>
                                                                                                    <div class="form-group">
                                                                                                        <div class="col-lg-12">
                                                                                                            <div class="pull-right">
                                                                                                                <button type="reset" class="btn btn-outline-primary" data-dismiss="modal">@localizzatore["Annulla"]</button>
                                                                                                                <button type="submit" class="btn btn-success">@localizzatore["Inserisci"]</button>
                                                                                                            </div>
                                                                                                        </div>
                                                                                                    </div>
                                                                                                </fieldset>
                                                                                            </form>
                                                                                        </div>
                                                                                    </div>
                                                                                </div>
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                    <!-- #endregion -->
                                                                    <dt>
                                                                        @if (await autorizzatore.AuthorizeAsync(User, "ModificaModiPreparazioneEsemplare"))
                                                                        {
                                                                            <i role="button"
                                                                               class="fa fa-pencil fa-pull-left fa-fw text-muted"
                                                                               data-toggle="modal"
                                                                               data-target="#modaleModiPreparazione"
                                                                               ng-click="vm.apriModaleModiPreparazione()"></i>
                                                                        }
                                                                        @localizzatore["Modo di Preparazione e Collocazione"]:
                                                                    </dt>
                                                                    <dd>
                                                                        <ul class="list-unstyled">
                                                                            @foreach (var preparato in Model.Preparati.OrderBy(preparato => preparato.Ordinamento))
                                                                            {
                                                                                <li>
                                                                                    @(preparato.Parte.Parte +
                                                " (" +
                                                preparato.Vassoio.Cassetto.Armadio.Sala.Sala +
                                                ", " +
                                                preparato.Vassoio.Cassetto.Armadio.Armadio +
                                                ", " +
                                                preparato.Vassoio.Cassetto.Cassetto +
                                                ", " +
                                                preparato.Vassoio.Vassoio + ")")
                                                                                </li>
                                                                            }
                                                                        </ul>
                                                                    </dd>
                                                                </div>
                                                                <div class="card card-outline-secondary" ng-controller="modalePreparazioneController as vm">
                                                                    <!-- #region modalePreparazione -->
                                                                    <div class="modal fade" id="modalePreparazione" role="dialog">
                                                                        <div class="modal-dialog modal-lg">
                                                                            <div class="modal-content">
                                                                                <div class="modal-body">
                                                                                    <div class="panel panel-primary">
                                                                                        <div class="panel-heading">
                                                                                            <h3 class="panel-title">@localizzatore["Inserire i nuovi valori"]:<i role="button" class="fa fa-close fa-pull-right text-white" data-dismiss="modal"></i></h3>
                                                                                        </div>
                                                                                        <div class="panel-body">
                                                                                            <form class="form-horizontal"
                                                                                                  asp-controller="UpdateDettaglioEsemplare"
                                                                                                  asp-action="AggiornaPreparazione"
                                                                                                  id="formPreparazione"
                                                                                                  name="formPreparazione">
                                                                                                <fieldset>

                                                                                                    <input type="hidden" id="esemplarehiddenPreparazione" asp-for="Id" value="@Model.Id" />

                                                                                                    <div class="form-group">
                                                                                                        <label for="inputDataPreparazione" class="col-lg-4 control-label">@localizzatore["Data di Preparazione"]:</label>
                                                                                                        <div class="col-lg-4">
                                                                                                            <input type="hidden" id="hiddenDataPreparazione" value="@Model.DataPreparazione" />
                                                                                                            <input id="inputDataPreparazione"
                                                                                                                   name="inputDataPreparazione"
                                                                                                                   ng-model="vm.dataPreparazione"
                                                                                                                   type="date"
                                                                                                                   class="form-control">
                                                                                                        </div>
                                                                                                        <div>
                                                                                                            <input type="radio" name="tipoDataPreparazione" ng-model="vm.tipoDataPreparazione" value="Data completa" />
                                                                                                            <input type="radio" name="tipoDataPreparazione" ng-model="vm.tipoDataPreparazione" value="Ignora mese/giorno" />
                                                                                                            <input type="radio" name="tipoDataPreparazione" ng-model="vm.tipoDataPreparazione" value="Ignora giorno" />
                                                                                                            <span role="button"
                                                                                                                  ng-show="vm.tipoDataPreparazione == 'Data completa'"
                                                                                                                  ng-click="vm.tipoDataPreparazione = 'Ignora mese/giorno'">@localizzatore["Data completa"]</span>
                                                                                                                <span role="button"
                                                                                                                      ng-show="vm.tipoDataPreparazione == 'Ignora mese/giorno'"
                                                                                                                      ng-click="vm.tipoDataPreparazione = 'Ignora giorno'">@localizzatore["Ignora mese/giorno"]</span>
                                                                                                                    <span role="button"
                                                                                                                          ng-show="vm.tipoDataPreparazione == 'Ignora giorno'"
                                                                                                                          ng-click="vm.tipoDataPreparazione = 'Data completa'">@localizzatore["Ignora giorno"]</span>
                                                                                                                    </div>
                                                                                                                </div>


                                                                                                                <div class="form-group">
                                                                                                                    <label for="inputScheda" class="col-lg-4 control-label">@localizzatore["Scheda"]:</label>
                                                                                                                    <div class="col-lg-4">
                                                                                                                        <input class="form-control"
                                                                                                                               id="inputScheda"
                                                                                                                               name="inputScheda"
                                                                                                                               type="number"
                                                                                                                               min="1" step="1"
                                                                                                                               oninput="validaFormPreparazione();"
                                                                                                                               value="@funzioni.convertiNumero(Model.Scheda)" />
                                                                                                                    </div>
                                                                                                                </div>

                                                                                                                <div class="form-group">
                                                                                                                    <label for="uiselectPreparatori" class="col-lg-4 control-label">@localizzatore["Preparatori"]:</label>
                                                                                                                    <div class="col-lg-4">
                                                                                                                        <ui-select id="uiselectPreparatori" ng-model="vm.preparatoreSelezionato">
                                                                                                                            <ui-select-match>
                                                                                                                                <span ng-bind="$select.selected.nome + ' ' + $select.selected.cognome"></span>
                                                                                                                            </ui-select-match>
                                                                                                                            <ui-select-choices repeat="preparatore in (vm.preparatori | filter: $select.search) track by preparatore.id">
                                                                                                                                <span ng-bind="preparatore.nome + ' ' + preparatore.cognome"></span>
                                                                                                                            </ui-select-choices>
                                                                                                                        </ui-select>
                                                                                                                    </div>
                                                                                                                    <div class="col-lg-1">
                                                                                                                        <i role="button" ng-click="vm.aggiungiPreparatore()" class="fa fa-plus-square fa-2x text-success"></i>
                                                                                                                    </div>
                                                                                                                </div>

                                                                                                                <div class="form-group">
                                                                                                                    <div class="col-lg-offset-2 col-lg-8">
                                                                                                                        <div style="overflow-y:auto; overflow-x:hidden; max-height:300px;">
                                                                                                                            <input type="hidden" id="tabellaElencoPreparatoriSerializzata" name="tabellaElencoPreparatoriSerializzata" />
                                                                                                                            <table datatable="ng" class="table table-striped table-bordered table-hover text-primary" id="tabellaElencoPreparatori" dt-options="vm.opzioniTabellaElencoPreparatori">
                                                                                                                                <thead>
                                                                                                                                    <tr>
                                                                                                                                        <th>@localizzatore["Ordinamento"]</th>
                                                                                                                                        <th>@localizzatore["Preparatore"]</th>
                                                                                                                                        <th></th>
                                                                                                                                    </tr>
                                                                                                                                </thead>
                                                                                                                                <tbody>
                                                                                                                                    <tr ng-repeat="preparatore in vm.datiTabellaElencoPreparatori">
                                                                                                                                        <td>{{$index+1}}</td>
                                                                                                                                        <td>{{preparatore.nome + " " + preparatore.cognome}}</td>
                                                                                                                                        <td>
                                                                                                                                            <div class="btn-group fa-pull-right">
                                                                                                                                                <i role="button" ng-show="!$first" ng-click="vm.spostaSu($index)" class="fa fa-arrow-up fa-2x text-success"></i>
                                                                                                                                                <i role="button" ng-show="!$last" ng-click="vm.spostaGiu($index)" class="fa fa-arrow-down fa-2x text-success"></i>
                                                                                                                                                <i role="button" ng-click="vm.rimuoviPreparatore(preparatore)" class="fa fa-minus-square fa-2x text-danger"></i>
                                                                                                                                            </div>
                                                                                                                                        </td>
                                                                                                                                    </tr>
                                                                                                                                </tbody>
                                                                                                                            </table>
                                                                                                                        </div>
                                                                                                                    </div>
                                                                                                                </div>

                                                                                                                <div class="form-group">
                                                                                                                    <label for="inputNotePreparazione" class="col-lg-4 control-label">@localizzatore["Note di Preparazione"]:</label>
                                                                                                                    <div class="col-lg-6">
                                                                                                                        <textarea class="form-control" rows="3" id="inputNotePreparazione" name="inputNotePreparazione">@Model.NotePreparazione</textarea>
                                                                                                                    </div>
                                                                                                                </div>

                                                                                                                <div class="form-group">
                                                                                                                    <div class="col-lg-12">
                                                                                                                        <div class="pull-right">
                                                                                                                            <button type="reset" class="btn btn-outline-primary" data-dismiss="modal">@localizzatore["Annulla"]</button>
                                                                                                                            <button id="bottoneSubmitPreparazione" type="submit" class="btn btn-success">@localizzatore["Inserisci"]</button>
                                                                                                                        </div>
                                                                                                                    </div>
                                                                                                                </div>
                                                                                                            </fieldset>
                                                                                                        </form>
                                                                                                    </div>
                                                                                                </div>
                                                                                            </div>
                                                                                        </div>
                                                                                    </div>
                                                                                </div>
                                                                                <!-- #endregion -->
                                                                                <dt>
                                                                                    @if (await autorizzatore.AuthorizeAsync(User, "ModificaPreparazioneEsemplare"))
                                                                                    {
                                                                                        <i role="button"
                                                                                           class="fa fa-pencil fa-pull-left fa-fw text-muted"
                                                                                           data-toggle="modal"
                                                                                           data-target="#modalePreparazione"
                                                                                           ng-click="vm.apriModalePreparazione();"></i>
                                                                                    }
                                                                                    @localizzatore["Data di Preparazione"]:
                                                                                </dt>
                                                                                <dd>@funzioni.leggiData(Model.DataPreparazione)</dd>
                                                                                <dt>@localizzatore["Scheda"]:</dt>
                                                                                <dd>@Model.Scheda</dd>
                                                                                <dt>@localizzatore["Preparatori"]:</dt>
                                                                                <dd>
                                                                                    <ul class="list-unstyled">
                                                                                        @foreach (var preparatore in Model.Preparazioni.OrderBy(preparatore => preparatore.Ordinamento))
                                                                                        {
                                                                                            <li>
                                                                                                @(preparatore.Preparatore.Nome + " " + preparatore.Preparatore.Cognome)
                                                                                            </li>
                                                                                        }
                                                                                    </ul>
                                                                                </dd>
                                                                                <dt>@localizzatore["Note di Preparazione"]:</dt>
                                                                                <dd>
                                                                                    <textarea rows="3" readonly style="resize:none; border:none;">@Model.NotePreparazione</textarea>
                                                                                </dd>
                                                                            </div>
                                                                        </dl>
                                                                    </div>

                                                                    <div class="card card-outline-secondary">
                                                                        <div class="row">
                                                                            <!-- #region modaleMorfologia -->
                                                                            <div class="modal fade" id="modaleMorfologia" role="dialog">
                                                                                <div class="modal-dialog modal-lg">
                                                                                    <div class="modal-content">
                                                                                        <div class="modal-body">

                                                                                            <div class="panel panel-primary">
                                                                                                <div class="panel-heading">
                                                                                                    <h3 class="panel-title">@localizzatore["Inserire i nuovi valori"]:<i role="button" class="fa fa-close fa-pull-right text-white" data-dismiss="modal"></i></h3>
                                                                                                </div>
                                                                                                <div class="panel-body">

                                                                                                    <form class="form-horizontal"
                                                                                                          asp-controller="UpdateDettaglioEsemplare"
                                                                                                          asp-action="AggiornaMorfologia"
                                                                                                          id="formMorfologia"
                                                                                                          name="formMorfologia">
                                                                                                        <fieldset>
                                                                                                            <ul class="nav nav-tabs">
                                                                                                                <li class="active"><a href="#tabmisure" data-toggle="tab">@localizzatore["Misure generali"]</a></li>
                                                                                                                <li class=""><a href="#tabbecco" data-toggle="tab">@localizzatore["Becco"]</a></li>
                                                                                                                <li class=""><a href="#tabocchio" data-toggle="tab">@localizzatore["Occhio"]</a></li>
                                                                                                                <li class=""><a href="#tabali" data-toggle="tab">@localizzatore["Ali"]</a></li>
                                                                                                                <li class=""><a href="#tabzampe" data-toggle="tab">@localizzatore["Zampe"]</a></li>
                                                                                                                <li class=""><a href="#tabanello" data-toggle="tab">@localizzatore["Anello"]</a></li>
                                                                                                                <li class=""><a href="#tabcontenuti" data-toggle="tab">@localizzatore["Contenuti"]</a></li>
                                                                                                            </ul>

                                                                                                            <input type="hidden" id="esemplarehiddenMorfologia" asp-for="Id" value="@Model.Id" />

                                                                                                            <div id="myTabContent" class="tab-content text-primary">

                                                                                                                <div class="tab-pane fade active in col-lg-offset-2" id="tabmisure">
                                                                                                                    <div class="form-group">
                                                                                                                        <label for="inputPeso" class="col-lg-4 control-label ">@localizzatore["Peso"] (g):</label>
                                                                                                                        <div class="col-lg-3">
                                                                                                                            <input id="inputPeso"
                                                                                                                                   name="inputPeso"
                                                                                                                                   type="number" min="0" step=".1"
                                                                                                                                   class="form-control"
                                                                                                                                   oninput="validaFormMorfologia();"
                                                                                                                                   value="@funzioni.convertiNumero(Model.Peso)">
                                                                                                                        </div>
                                                                                                                    </div>
                                                                                                                    <div class="form-group">
                                                                                                                        <label for="inputLunghezzaTotale" class="col-lg-4 control-label">@localizzatore["Lunghezza Totale"] (cm):</label>
                                                                                                                        <div class="col-lg-3">
                                                                                                                            <input id="inputLunghezzaTotale"
                                                                                                                                   name="inputLunghezzaTotale"
                                                                                                                                   type="number" min="0" step=".1"
                                                                                                                                   class="form-control"
                                                                                                                                   oninput="validaFormMorfologia();"
                                                                                                                                   value="@funzioni.convertiNumero(Model.LunghezzaTotale)">
                                                                                                                        </div>
                                                                                                                    </div>

                                                                                                                </div>

                                                                                                                <div class="tab-pane fade col-lg-offset-3" id="tabbecco">
                                                                                                                    <div class="form-group">
                                                                                                                        <label for="inputColoreBecco" class="col-lg-3 control-label">@localizzatore["Colore Becco"]:</label>
                                                                                                                        <div class="col-lg-4">
                                                                                                                            <input id="inputColoreBecco"
                                                                                                                                   name="inputColoreBecco"
                                                                                                                                   type="text"
                                                                                                                                   class="form-control"
                                                                                                                                   value="@Model.ColoreBecco">
                                                                                                                        </div>
                                                                                                                    </div>
                                                                                                                    <div class="form-group">
                                                                                                                        <label for="inputBeccoCranio" class="col-lg-4 control-label">@localizzatore["Becco-Cranio"] (mm):</label>
                                                                                                                        <div class="col-lg-3">
                                                                                                                            <input id="inputBeccoCranio"
                                                                                                                                   name="inputBeccoCranio"
                                                                                                                                   type="number" min="0" step=".1"
                                                                                                                                   class="form-control"
                                                                                                                                   oninput="validaFormMorfologia();"
                                                                                                                                   value="@funzioni.convertiNumero(Model.BeccoCranio)">
                                                                                                                        </div>
                                                                                                                    </div>
                                                                                                                    <div class="form-group">
                                                                                                                        <label for="inputCulmine" class="col-lg-4 control-label">@localizzatore["Culmine"] (mm):</label>
                                                                                                                        <div class="col-lg-3">
                                                                                                                            <input id="inputCulmine"
                                                                                                                                   name="inputCulmine"
                                                                                                                                   type="number" min="0" step=".1"
                                                                                                                                   class="form-control"
                                                                                                                                   oninput="validaFormMorfologia();"
                                                                                                                                   value="@funzioni.convertiNumero(Model.Culmine)">
                                                                                                                        </div>
                                                                                                                    </div>
                                                                                                                </div>

                                                                                                                <div class="tab-pane fade col-lg-offset-2" id="tabocchio">
                                                                                                                    <div class="form-group">
                                                                                                                        <label for="inputDimensioneOcchio" class="col-lg-4 control-label">@localizzatore["Dimensione Occhio"] (mm):</label>
                                                                                                                        <div class="col-lg-3">
                                                                                                                            <input id="inputDimensioneOcchio"
                                                                                                                                   name="inputDimensioneOcchio"
                                                                                                                                   type="number" min="0" step=".1"
                                                                                                                                   class="form-control"
                                                                                                                                   oninput="validaFormMorfologia();"
                                                                                                                                   value="@funzioni.convertiNumero(Model.DimensioneOcchio)">
                                                                                                                        </div>
                                                                                                                    </div>
                                                                                                                    <div class="form-group">
                                                                                                                        <label for="inputColoreIride" class="col-lg-4 control-label">@localizzatore["Colore Iride"]:</label>
                                                                                                                        <div class="col-lg-4">
                                                                                                                            <input id="inputColoreIride"
                                                                                                                                   name="inputColoreIride"
                                                                                                                                   type="text"
                                                                                                                                   class="form-control"
                                                                                                                                   value="@Model.ColoreIride">
                                                                                                                        </div>
                                                                                                                    </div>
                                                                                                                </div>

                                                                                                                <div class="tab-pane fade col-lg-offset-2" id="tabali">

                                                                                                                    <div class="form-group">
                                                                                                                        <label for="inputAperturaAlare" class="col-lg-4 control-label">@localizzatore["Apertura Alare"] (cm):</label>
                                                                                                                        <div class="col-lg-3">
                                                                                                                            <input id="inputAperturaAlare"
                                                                                                                                   name="inputAperturaAlare"
                                                                                                                                   type="number" min="0" step=".1"
                                                                                                                                   class="form-control"
                                                                                                                                   oninput="validaFormMorfologia();"
                                                                                                                                   value="@funzioni.convertiNumero(Model.AperturaAlare)">
                                                                                                                        </div>
                                                                                                                    </div>
                                                                                                                    <div class="form-group">
                                                                                                                        <label for="inputAla" class="col-lg-4 control-label">@localizzatore["Ala"] (mm):</label>
                                                                                                                        <div class="col-lg-3">
                                                                                                                            <input id="inputAla"
                                                                                                                                   name="inputAla"
                                                                                                                                   type="number" min="0" step=".1"
                                                                                                                                   class="form-control"
                                                                                                                                   oninput="validaFormMorfologia();"
                                                                                                                                   value="@funzioni.convertiNumero(Model.Ala)">
                                                                                                                        </div>
                                                                                                                    </div>
                                                                                                                    <div class="form-group">
                                                                                                                        <label for="inputTimoniereCentrali" class="col-lg-4 control-label">@localizzatore["Timoniere Centrali"] (mm):</label>
                                                                                                                        <div class="col-lg-3">
                                                                                                                            <input id="inputTimoniereCentrali"
                                                                                                                                   name="inputTimoniereCentrali"
                                                                                                                                   type="number" min="0" step=".1"
                                                                                                                                   class="form-control"
                                                                                                                                   oninput="validaFormMorfologia();"
                                                                                                                                   value="@funzioni.convertiNumero(Model.TimoniereCentrali)">
                                                                                                                        </div>
                                                                                                                    </div>
                                                                                                                    <div class="form-group">
                                                                                                                        <label for="inputTimoniereEsterne" class="col-lg-4 control-label">@localizzatore["Timoniere Esterne"] (mm):</label>
                                                                                                                        <div class="col-lg-3">
                                                                                                                            <input id="inputTimoniereEsterne"
                                                                                                                                   name="inputTimoniereEsterne"
                                                                                                                                   type="number" min="0" step=".1"
                                                                                                                                   class="form-control"
                                                                                                                                   oninput="validaFormMorfologia();"
                                                                                                                                   value="@funzioni.convertiNumero(Model.TimoniereEsterne)">
                                                                                                                        </div>
                                                                                                                    </div>
                                                                                                                    <div class="form-group">
                                                                                                                        <label for="inputRemigante3" class="col-lg-4 control-label">@localizzatore["Remigante 3"] (mm):</label>
                                                                                                                        <div class="col-lg-3">
                                                                                                                            <input id="inputRemigante3"
                                                                                                                                   name="inputRemigante3"
                                                                                                                                   type="number" min="0" step=".1"
                                                                                                                                   class="form-control"
                                                                                                                                   oninput="validaFormMorfologia();"
                                                                                                                                   value="@funzioni.convertiNumero(Model.Remigante3)">
                                                                                                                        </div>
                                                                                                                    </div>
                                                                                                                    <div class="form-group">
                                                                                                                        <label for="inputFormulaAlareE" class="col-lg-4 control-label">@localizzatore["Formula Alare E"]:</label>
                                                                                                                        <div class="col-lg-3">
                                                                                                                            <input id="inputFormulaAlareE"
                                                                                                                                   name="inputFormulaAlareE"
                                                                                                                                   type="number" min="0" step=".1"
                                                                                                                                   class="form-control"
                                                                                                                                   oninput="validaFormMorfologia();"
                                                                                                                                   value="@funzioni.convertiNumero(Model.FormulaAlareE)">
                                                                                                                        </div>
                                                                                                                    </div>
                                                                                                                    <div class="form-group">
                                                                                                                        <label for="inputFormulaAlareWP" class="col-lg-4 control-label">@localizzatore["Formula Alare WP"]:</label>
                                                                                                                        <div class="col-lg-3">
                                                                                                                            <input id="inputFormulaAlareWP"
                                                                                                                                   name="inputFormulaAlareWP"
                                                                                                                                   type="number" min="0" step=".1"
                                                                                                                                   class="form-control"
                                                                                                                                   oninput="validaFormMorfologia();"
                                                                                                                                   value="@funzioni.convertiNumero(Model.FormulaAlareWp)">
                                                                                                                        </div>
                                                                                                                    </div>
                                                                                                                    <div class="form-group">
                                                                                                                        <label for="inputFormulaAlare2" class="col-lg-4 control-label">@localizzatore["Formula Alare 2"]:</label>
                                                                                                                        <div class="col-lg-3">
                                                                                                                            <input id="inputFormulaAlare2"
                                                                                                                                   name="inputFormulaAlare2"
                                                                                                                                   type="number" min="0" step=".1"
                                                                                                                                   class="form-control"
                                                                                                                                   oninput="validaFormMorfologia();"
                                                                                                                                   value="@funzioni.convertiNumero(Model.FormulaAlare2)">
                                                                                                                        </div>
                                                                                                                    </div>
                                                                                                                </div>

                                                                                                                <div class="tab-pane fade col-lg-offset-3" id="tabzampe">
                                                                                                                    <div class="form-group">
                                                                                                                        <label for="inputTarso" class="col-lg-3 control-label">@localizzatore["Tarso"] (mm):</label>
                                                                                                                        <div class="col-lg-3">
                                                                                                                            <input id="inputTarso"
                                                                                                                                   name="inputTarso"
                                                                                                                                   type="number" min="0" step=".1"
                                                                                                                                   class="form-control"
                                                                                                                                   oninput="validaFormMorfologia();"
                                                                                                                                   value="@funzioni.convertiNumero(Model.Tarso)">
                                                                                                                        </div>
                                                                                                                    </div>
                                                                                                                    <div class="form-group">
                                                                                                                        <label for="inputColoreZampe" class="col-lg-3 control-label">@localizzatore["Colore Zampe"]:</label>
                                                                                                                        <div class="col-lg-3">
                                                                                                                            <input id="inputColoreZampe"
                                                                                                                                   name="inputColoreZampe"
                                                                                                                                   type="text"
                                                                                                                                   class="form-control"
                                                                                                                                   value="@Model.ColoreZampe">
                                                                                                                        </div>
                                                                                                                    </div>
                                                                                                                </div>

                                                                                                                <div class="tab-pane fade col-lg-offset-2" id="tabanello">
                                                                                                                    <div class="form-group">
                                                                                                                        <label class="col-lg-4 control-label">@localizzatore["Inanellato"]:</label>
                                                                                                                        <div class="col-lg-3">
                                                                                                                            <div class="radio">
                                                                                                                                <label>
                                                                                                                                    <input id="inputInanellatoSi"
                                                                                                                                           name="inputInanellato"
                                                                                                                                           type="radio"
                                                                                                                                           value="true"
                                                                                                                                           checked="@Model.Inanellato ? 'checked' : ''">
                                                                                                                                    @localizzatore["Sì"]
                                                                                                                                </label>
                                                                                                                            </div>
                                                                                                                            <div class="radio">
                                                                                                                                <label>
                                                                                                                                    <input id="inputInanellatoNo"
                                                                                                                                           name="inputInanellato"
                                                                                                                                           type="radio"
                                                                                                                                           value="false"
                                                                                                                                           checked="@Model.Inanellato ? '' : 'checked'">
                                                                                                                                    @localizzatore["No"]
                                                                                                                                </label>
                                                                                                                            </div>
                                                                                                                        </div>
                                                                                                                    </div>
                                                                                                                    <div class="form-group">
                                                                                                                        <label for="inputDatiAnello" class="col-lg-4 control-label">@localizzatore["Dati Anello"]:</label>
                                                                                                                        <div class="col-lg-6">
                                                                                                                            <input id="inputDatiAnello"
                                                                                                                                   name="inputDatiAnello"
                                                                                                                                   type="text"
                                                                                                                                   class="form-control"
                                                                                                                                   value="@Model.DatiAnello">
                                                                                                                        </div>
                                                                                                                    </div>
                                                                                                                </div>

                                                                                                                <div class="tab-pane fade col-lg-offset-2" id="tabcontenuti">
                                                                                                                    <div class="form-group">
                                                                                                                        <label for="inputContenutoIngluvie" class="col-lg-4 control-label">@localizzatore["Contenuto Ingluvie"]:</label>
                                                                                                                        <div class="col-lg-6">
                                                                                                                            <input id="inputContenutoIngluvie"
                                                                                                                                   name="inputContenutoIngluvie"
                                                                                                                                   type="text"
                                                                                                                                   class="form-control"
                                                                                                                                   value="@Model.ContenutoIngluvie">
                                                                                                                        </div>
                                                                                                                    </div>
                                                                                                                    <div class="form-group">
                                                                                                                        <label for="inputContenutoStomaco" class="col-lg-4 control-label">@localizzatore["Contenuto Stomaco"]:</label>
                                                                                                                        <div class="col-lg-6">
                                                                                                                            <input id="inputContenutoStomaco"
                                                                                                                                   name="inputContenutoStomaco"
                                                                                                                                   type="text"
                                                                                                                                   class="form-control"
                                                                                                                                   value="@Model.ContenutoStomaco">
                                                                                                                        </div>
                                                                                                                    </div>
                                                                                                                </div>
                                                                                                            </div>
                                                                                                            <br />
                                                                                                            <div class="form-group">
                                                                                                                <div class="col-lg-12">
                                                                                                                    <div class="pull-right">
                                                                                                                        <button type="reset" class="btn btn-outline-primary" data-dismiss="modal">@localizzatore["Annulla"]</button>
                                                                                                                        <button id="bottoneSubmitMorfologia" type="submit" class="btn btn-success">@localizzatore["Inserisci"]</button>
                                                                                                                    </div>
                                                                                                                </div>
                                                                                                            </div>
                                                                                                        </fieldset>
                                                                                                    </form>
                                                                                                </div>
                                                                                            </div>
                                                                                        </div>
                                                                                    </div>
                                                                                </div>
                                                                            </div>
                                                                            <!-- #endregion -->
                                                                            <dl class="col-lg-3 dl-horizontal text-primary">
                                                                                <dt>
                                                                                    @if (await autorizzatore.AuthorizeAsync(User, "ModificaMorfologiaEsemplare"))
                                                                                    {
                                                                                        <i role="button" class="fa fa-pencil fa-pull-left fa-fw text-muted" data-toggle="modal" data-target="#modaleMorfologia"></i>
                                                                                    }

                                                                                    @localizzatore["Peso"] (g):
                                                                                </dt>
                                                                                <dd>@Model.Peso</dd>
                                                                                <dt>@localizzatore["Lunghezza Totale"] (cm):</dt>
                                                                                <dd>@Model.LunghezzaTotale</dd>
                                                                                <dt>@localizzatore["Apertura Alare"] (cm):</dt>
                                                                                <dd>@Model.AperturaAlare</dd>
                                                                                <dt>@localizzatore["Becco-Cranio"]:</dt>
                                                                                <dd>@Model.BeccoCranio</dd>
                                                                                <dt>@localizzatore["Culmine"]:</dt>
                                                                                <dd>@Model.Culmine</dd>
                                                                            </dl>

                                                                            <dl class="col-lg-3 dl-horizontal text-primary">
                                                                                <dt>@localizzatore["Colore Becco"]:</dt>
                                                                                <dd>@Model.ColoreBecco</dd>
                                                                                <dt>@localizzatore["Ala"] (mm):</dt>
                                                                                <dd>@Model.Ala</dd>
                                                                                <dt>@localizzatore["Remigante 3"] (mm):</dt>
                                                                                <dd>@Model.Remigante3</dd>
                                                                                <dt>@localizzatore["Tarso"] (mm):</dt>
                                                                                <dd>@Model.Tarso</dd>
                                                                                <dt>@localizzatore["Colore Zampe"]:</dt>
                                                                                <dd>@Model.ColoreZampe</dd>
                                                                            </dl>

                                                                            <dl class="col-lg-3 dl-horizontal text-primary">
                                                                                <dt>@localizzatore["Timoniere Centrali"] (mm):</dt>
                                                                                <dd>@Model.TimoniereCentrali</dd>
                                                                                <dt>@localizzatore["Timoniere Esterne"] (mm):</dt>
                                                                                <dd>@Model.TimoniereEsterne</dd>
                                                                                <dt>@localizzatore["Dimensione Occhio"] (mm):</dt>
                                                                                <dd>@Model.DimensioneOcchio</dd>
                                                                                <dt>@localizzatore["Colore Iride"]:</dt>
                                                                                <dd>@Model.ColoreIride</dd>
                                                                            </dl>

                                                                            <dl class="col-lg-3 dl-horizontal text-primary">
                                                                                <dt>@localizzatore["Formula Alare E"]:</dt>
                                                                                <dd>@Model.FormulaAlareE</dd>
                                                                                <dt>@localizzatore["Formula Alare WP"]:</dt>
                                                                                <dd>@Model.FormulaAlareWp</dd>
                                                                                <dt>@localizzatore["Formula Alare 2"]:</dt>
                                                                                <dd>@Model.FormulaAlare2</dd>
                                                                                <dt>@localizzatore["Inanellato"]:</dt>
                                                                                <dd>@((bool)Model.Inanellato ? localizzatore["Sì"] : localizzatore["No"])</dd>
                                                                                <dt>@localizzatore["Dati Anello"]:</dt>
                                                                                <dd>@Model.DatiAnello</dd>
                                                                                <dt>@localizzatore["Contenuto Ingluvie"]:</dt>
                                                                                <dd>@Model.ContenutoIngluvie</dd>
                                                                                <dt>@localizzatore["Contenuto Stomaco"]:</dt>
                                                                                <dd>@Model.ContenutoStomaco</dd>
                                                                            </dl>

                                                                        </div>
                                                                    </div>
                                                                    <div class="card card-outline-secondary">
                                                                        <!-- #region modaleBibliografiaNote -->
                                                                        <div class="modal fade" id="modaleBibliografiaNote" role="dialog">
                                                                            <div class="modal-dialog modal-lg">
                                                                                <div class="modal-content">
                                                                                    <div class="modal-body">
                                                                                        <div class="panel panel-primary">
                                                                                            <div class="panel-heading">
                                                                                                <h3 class="panel-title">@localizzatore["Inserire i nuovi valori"]:<i role="button" class="fa fa-close fa-pull-right text-white" data-dismiss="modal"></i></h3>
                                                                                            </div>
                                                                                            <div class="panel-body">
                                                                                                <form class="form-horizontal"
                                                                                                      asp-controller="UpdateDettaglioEsemplare"
                                                                                                      asp-action="AggiornaBibliografiaNote"
                                                                                                      id="formBibliografiaNote"
                                                                                                      name="formBibliografiaNote">
                                                                                                    <fieldset>

                                                                                                        <input type="hidden" id="esemplarehiddenBibliografiaNote" asp-for="Id" value="@Model.Id" />

                                                                                                        <div class="form-group">
                                                                                                            <label for="inputBibliografia" class="col-lg-4 control-label text-primary">@localizzatore["Bibliografia"]:</label>
                                                                                                            <div class="col-lg-6">
                                                                                                                <textarea maxlength="255" class="form-control" rows="2" id="inputBibliografia" name="inputBibliografia">@Model.Bibliografia</textarea>
                                                                                                            </div>
                                                                                                        </div>

                                                                                                        <div class="form-group">
                                                                                                            <label for="inputNote" class="col-lg-4 control-label text-primary">@localizzatore["Note"]:</label>
                                                                                                            <div class="col-lg-6">
                                                                                                                <textarea class="form-control" rows="3" id="inputNote" name="inputNote">@Model.Note</textarea>
                                                                                                            </div>
                                                                                                        </div>

                                                                                                        <div class="form-group">
                                                                                                            <div class="col-lg-12">
                                                                                                                <div class="pull-right">
                                                                                                                    <button type="reset" class="btn btn-outline-primary" data-dismiss="modal">@localizzatore["Annulla"]</button>
                                                                                                                    <button id="bottoneSubmitDeterminazioni" type="submit" class="btn btn-success">@localizzatore["Inserisci"]</button>
                                                                                                                </div>
                                                                                                            </div>
                                                                                                        </div>
                                                                                                    </fieldset>
                                                                                                </form>
                                                                                            </div>
                                                                                        </div>
                                                                                    </div>
                                                                                </div>
                                                                            </div>
                                                                        </div>
                                                                        <!-- #endregion -->
                                                                        <div class="row">
                                                                            <dl class="col-lg-3 dl-horizontal text-primary">
                                                                                <dt>
                                                                                    @if (await autorizzatore.AuthorizeAsync(User, "ModificaBibliografiaNoteEsemplare"))
                                                                                    {
                                                                                        <i role="button" class="fa fa-pencil fa-pull-left fa-fw text-muted" data-toggle="modal" data-target="#modaleBibliografiaNote"></i>
                                                                                    }
                                                                                    @localizzatore["Bibliografia"]:
                                                                                </dt>
                                                                                <dd>@Model.Bibliografia</dd>
                                                                            </dl>

                                                                            <dl class="col-lg-9 dl-horizontal text-primary">
                                                                                <dt>@localizzatore["Note"]:</dt>
                                                                                <dd>
                                                                                    <textarea rows="4" cols="80" width="100%" readonly style="resize:none; border:none;">@Model.Note</textarea>
                                                                                </dd>
                                                                            </dl>
                                                                        </div>
                                                                    </div>

                                                                </div>
    }
        </div>
    </div>
</div>
